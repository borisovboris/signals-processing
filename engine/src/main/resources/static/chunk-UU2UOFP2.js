import{a as Mn}from"./chunk-RXVEORVH.js";import{a as vo,b as xe,c as ja}from"./chunk-U5VWOXID.js";import{c as bn,d as it,e as Lt,h as $t,i as li,j as me,l as de,m as he,n as ge,o as mo,p as Rt}from"./chunk-OTL7X6PS.js";import{a as tt,b as ho,c as et,d as go,e as xo,f as ci}from"./chunk-SPCOMQNX.js";import{b as Vt,c as wn}from"./chunk-4S6LF2QW.js";import{a as gt}from"./chunk-2JCW2XGL.js";import{a as Ht,d as k,e as co,q as R,t as Ut,u as uo,v as fo,x as bt,y as po}from"./chunk-7FJ4ADOC.js";import{$b as Ne,B as De,Ca as Yt,D as si,E as Ee,Ea as S,Ec as H,Ga as N,Ja as g,Jb as ue,Ka as J,Kb as Et,L as A,La as X,Lb as fe,Ma as oo,Mb as Pt,N as Pe,Na as L,Oa as ln,P as no,Pa as cn,Qb as st,Ra as un,S as rn,Sa as fn,Sb as ao,T as an,Ta as pn,U as V,Ub as so,Vb as lt,Wa as le,Wb as hn,X as rt,Xb as gn,Y as at,Ya as mn,Za as Y,Zb as xn,_b as vn,a as ut,ac as _n,b as ft,bc as Nt,cc as wt,da as ae,dc as $,e as Ga,ec as Tt,gc as At,hc as lo,i as pt,ia as x,ic as yn,ja as w,jc as pe,ka as ht,kc as Ft,l as Z,la as sn,lc as Cn,mb as dn,nb as ro,oa as io,ob as ce,q as M,qa as y,ra as se,sa as P,ta as Ct,u as yt,v as W,x as Xt,xa as h,y as Q,ya as d,za as E}from"./chunk-OWV6CK4N.js";var _o=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=V({type:e,selectors:[["app-compositions"]],standalone:!0,features:[L],decls:1,vars:0,template:function(o,r){o&1&&E(0,"router-outlet")},dependencies:[ro],changeDetection:0});let t=e;return t})();var v=co({source:"Country",events:{"Get Compositions":(t={})=>({filters:t}),"Compositions Fetched":k(),"Composition fetched":k(),"Reset compositions":k(),"Details Fetched":k(),"Create device":k(),"Device created":k(),"Edit device":k(),"Device edited":k(),"Link compositions":k(),"Compositions linked":k(),"Unlink compositions":k(),"Compositions unlinked":k(),"Delete device":k(),"Device deleted":k(),"Get device details":k(),"Device details fetched":k(),"Create composition":k(),"Composition created":k(),"Edit composition":k(),"Composition edited":k(),"Delete composition":k(),"Composition deleted":k()}});var ve=uo(bn),yo=Ut(ve,t=>t.compositions),Co=Ut(ve,t=>t.details),_e=Ut(ve,t=>t.currentlyViewedCompositionId),wo=Ut(ve,t=>t.filters),bo=Ut(ve,t=>t.deviceDetails),Mo=Ut(ve,t=>t.currentlyViewedComposition);function Ha(t,e){t&1&&(h(0,"mat-error"),g(1,"Already exists for this location"),d())}var fi=(()=>{let e=class e{uniqueCodeValidator(){return n=>n.valueChanges.pipe(Xt(400),De(),yt(()=>it(n.get("locationCtrl")?.value)),A(o=>this.compositionService.checkIfCompositionExists(n.get("locationCtrl")?.value.value,n.get("code")?.value).pipe(M(r=>[r,o]))),M(([o,r])=>(o&&!$t(n.get("code")?.value,this.dialogData?.editInfo?.code)?n.get("code")?.setErrors({locationExists:!0}):delete n.get("code")?.errors?.notAnOption,this.changeRef.markForCheck(),null)),Ee())}constructor(n,o,r,a,s){this.store=n,this.injector=o,this.compositionService=r,this.countryService=a,this.changeRef=s,this.dialogData=this.injector.get(he),this.dialogRef=this.injector.get(de),this.inEditMode=!1,this.locations$=new pt([]),this.locationOptions$=this.locations$.asObservable(),this.locationCtrl=new $("",[Lt]),this.types$=new pt([]),this.typeOptions$=this.types$.asObservable(),this.typeCtrl=new $("",[Lt]),this.statuses$=new pt([]),this.statusOptions$=this.statuses$.asObservable(),this.statusCtrl=new $("",{validators:[Lt]}),this.form=new wt({nestedForm:new wt({code:new $("",[Ne.required]),locationCtrl:this.locationCtrl},{asyncValidators:[this.uniqueCodeValidator()]}),typeCtrl:this.typeCtrl,statusCtrl:this.statusCtrl,coordinates:new $(""),description:new $("")}),this.inEditMode=this.dialogData?.editInfo!==void 0}ngAfterViewInit(){this.dialogData?.editInfo!==void 0&&(this.code?.setValue(this.dialogData.editInfo?.code),this.location?.setValue(this.dialogData.editInfo?.location),this.type?.setValue(this.dialogData.editInfo?.type),this.status?.setValue(this.dialogData.editInfo?.status),this.coordinates?.setValue(li(this.dialogData.editInfo?.coordinates)),this.description?.setValue(li(this.dialogData.editInfo?.description)),this.form.markAllAsTouched(),this.form.updateValueAndValidity)}onLocationInput(n){this.countryService.readLocations({name:n}).pipe(M(o=>o.map(r=>({label:r.name,value:r.id}))),Q(1)).subscribe(o=>this.locations$.next(o))}onStatusInput(n){this.compositionService.readCompositionStatuses({name:n}).pipe(Q(1)).subscribe(o=>this.statuses$.next(o))}onTypeInput(n){this.compositionService.readCompositionTypes({name:n}).pipe(Q(1)).subscribe(o=>this.types$.next(o))}get formPending(){return this.form.pending}codeExists(){return this.code?.hasError("locationExists")}get code(){return this.form.get("nestedForm")?.get("code")}get location(){return this.form.get("nestedForm")?.get("locationCtrl")}get coordinates(){return this.form.get("coordinates")}get description(){return this.form.get("description")}get type(){return this.form.get("typeCtrl")}get status(){return this.form.get("statusCtrl")}createOrEditComposition(){this.inEditMode?this.editComposition():this.createComposition()}editComposition(){let{code:n,coordinates:o,description:r,location:a,type:s,status:l}=this.getCompositionData(),c=this.dialogData?.editInfo?.id;n&&c&&it(a)&&it(s)&&it(l)&&this.store.dispatch(v.editComposition({composition:{id:c,code:n,coordinates:o,description:r,statusId:l.value,typeId:s.value,locationId:a.value}})),this.dialogRef.close(!0)}createComposition(){let{code:n,coordinates:o,description:r,location:a,type:s,status:l}=this.getCompositionData();n&&it(a)&&it(s)&&it(l)&&this.store.dispatch(v.createComposition({composition:{code:n,coordinates:o,description:r,statusId:a.value,typeId:s.value,locationId:l.value}})),this.dialogRef.close(!0)}getCompositionData(){let n=this.code?.value??void 0,o=this.coordinates?.value??void 0,r=this.description?.value??void 0,a=this.location?.value,s=this.type?.value,l=this.status?.value;return{code:n,coordinates:o,description:r,location:a,type:s,status:l}}compositionChangedThroughEdit(){if(this.dialogData?.editInfo===void 0)return!0;let{code:n,coordinates:o,description:r,location:a,type:s,status:l}=this.getCompositionData(),{code:c,coordinates:u,description:f,location:p,type:m,status:_}=this.dialogData.editInfo,b=!$t(c,n),I=!$t(u,o),U=!$t(f,r),G=p.value!==me(a),T=m.value!==me(s),ot=_.value!==me(l);return b||I||U||G||T||ot}};e.\u0275fac=function(o){return new(o||e)(w(R),w(ae),w(Vt),w(wn),w(ht))},e.\u0275cmp=V({type:e,selectors:[["app-composition-form"]],standalone:!0,features:[L],decls:24,vars:14,consts:[[3,"formGroup"],["formGroupName","nestedForm"],[1,"example-full-width"],["formControlName","code","matInput",""],[4,"ngIf"],[3,"label","ctrl","options$","userTextInput"],["formControlName","coordinates","matInput",""],["formControlName","description","matInput",""],[1,"actions"],["type","button","mat-raised-button","","color","accent",3,"disabled","click"]],template:function(o,r){o&1&&(h(0,"mat-card")(1,"form",0)(2,"h1"),g(3),d(),h(4,"div",1)(5,"mat-form-field",2)(6,"mat-label"),g(7,"Code"),d(),E(8,"input",3),P(9,Ha,2,0,"mat-error",4),d(),h(10,"app-single-autocomplete",5),S("userTextInput",function(s){return r.onLocationInput(s)}),d()(),h(11,"app-single-autocomplete",5),S("userTextInput",function(s){return r.onTypeInput(s)}),d(),h(12,"app-single-autocomplete",5),S("userTextInput",function(s){return r.onStatusInput(s)}),d(),h(13,"mat-form-field",2)(14,"mat-label"),g(15,"Coordinates"),d(),E(16,"input",6),d(),h(17,"mat-form-field",2)(18,"mat-label"),g(19,"Description"),d(),E(20,"input",7),d(),h(21,"div",8)(22,"button",9),S("click",function(){return r.createOrEditComposition()}),g(23),d()()()()),o&2&&(x(1),y("formGroup",r.form),x(2),J(r.inEditMode?"Edit composition":"Add composition"),x(6),y("ngIf",r.codeExists()),x(1),y("label","Location")("ctrl",r.locationCtrl)("options$",r.locationOptions$),x(1),y("label","Type")("ctrl",r.typeCtrl)("options$",r.typeOptions$),x(1),y("label","Status")("ctrl",r.statusCtrl)("options$",r.statusOptions$),x(10),y("disabled",r.form.invalid||r.formPending===!0||!r.compositionChangedThroughEdit()),x(1),X(" ",r.inEditMode?"Edit":"Add"," "))},dependencies:[Y,le,xe,H,st,lt,xn,hn,gn,Cn,pe,Tt,vn,_n,Nt,Ft,At,yn,lo],styles:["mat-card[_ngcontent-%COMP%]{padding:20px 16px;width:400px}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:26px}mat-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:space-between}"],changeDetection:0});let t=e;return t})();var Ua=["cityChips"],Qa=["locationChips"];function Ka(t,e){if(t&1){let i=Yt();h(0,"div",16)(1,"div",17),S("click",function(){let r=rt(i).$implicit,a=N(2);return at(a.goToDetails(r.id))}),h(2,"p"),g(3),d(),h(4,"p"),g(5),d(),h(6,"p"),g(7),d(),h(8,"p"),g(9),d(),h(10,"app-list-actions",18),S("delete",function(){let r=rt(i).$implicit,a=N(2);return at(a.deleteComposition(r.id))})("edit",function(){let r=rt(i).$implicit,a=N(2);return at(a.openCompositionEditForm(r))}),d()()()}if(t&2){let i=e.$implicit;x(1),se("not-operational",!i.status.isOperational),x(2),J(i.code),x(2),J(i.devicesSize),x(2),J(i.type.label),x(2),X(" ",i.status.isOperational?"Operational":"Not operational"," ")}}function Za(t,e){if(t&1){let i=Yt();h(0,"div",11)(1,"div",12)(2,"p"),g(3,"Code"),d(),h(4,"p"),g(5,"Devices"),d(),h(6,"p"),g(7,"Type"),d(),h(8,"p"),g(9,"Status"),d(),h(10,"p"),g(11,"Actions"),d()(),h(12,"div",13)(13,"cdk-virtual-scroll-viewport",14),S("scrolledIndexChange",function(){rt(i);let o=N();return at(o.onScroll())}),P(14,Ka,11,6,"div",15),d()()()}if(t&2){let i=N();y("@fadeIn",void 0),x(13),y("itemSize",68),x(1),y("cdkVirtualForOf",i.compositions)}}function Wa(t,e){t&1&&E(0,"app-no-data")}var Io=(()=>{let e=class e extends mo{constructor(n,o,r,a,s,l){super(),this.store=n,this.router=o,this.route=r,this.dialogService=a,this.service=s,this.changeRef=l,this.citiesCtrl=new $([],{nonNullable:!0}),this.cityCtrl=new $("",{nonNullable:!0}),this.cities$=new pt([]),this.cityOptions$=this.cities$.asObservable(),this.locationsCtrl=new $([],{nonNullable:!0}),this.locationCtrl=new $("",{nonNullable:!0}),this.locations$=new pt([]),this.locationOptions$=this.locations$.asObservable(),this.cityNames=[],this.locationNames=[],this.destroyRef=an(sn),this.sidepanelForm=new wt({citiesCtrl:this.citiesCtrl,cityCtrl:this.cityCtrl,locationsCtrl:this.locationCtrl,locationCtr:this.locationCtrl})}ngOnInit(){this.scrolled$.pipe(Xt(300),Ht(this.destroyRef)).subscribe(()=>this.getOffset()),this.store.select(yo).pipe(Ht(this.destroyRef)).subscribe(n=>{this.compositions=n,this.changeRef.markForCheck()})}handleCityInput(n){this.service.readCitiesLikeName({name:n,exludedItemIds:this.getSelectedCities()}).pipe(Q(1),M(o=>o.map(r=>({label:r.name,value:r.id})))).subscribe(o=>this.cities$.next(o))}handleLocationInput(n){this.service.readLocations({name:n,exludedItemIds:this.getSelectedLocations()}).pipe(Q(1),M(o=>o.map(r=>({label:r.name,value:r.id})))).subscribe(o=>this.locations$.next(o))}handleCityChipsChange(){this.resetCompositions(),this.getCompositions(this.getSelectedCities(),this.getSelectedLocations())}handleLocationChipsChange(){this.resetCompositions(),this.getCompositions(this.getSelectedCities(),this.getSelectedLocations())}resetCompositions(){this.offset=0,this.store.dispatch(v.resetCompositions())}setInitialCityAndCountryName(n,o,r,a){this.citiesCtrl.setValue([n]),this.locationsCtrl.setValue([r]),this.cityChips.setChips([{label:o,value:Number(n)}]),this.locationChips.setChips([{label:a,value:Number(r)}])}ngAfterViewInit(){this.route.queryParams.pipe(Q(1)).subscribe(n=>{let o=n.cityId,r=n.cityName,a=n.locationId,s=n.locationName;if(o&&r&&a&&s){this.setInitialCityAndCountryName(o,r,a,s),this.getCompositions([Number(o)],[Number(a)]);return}this.store.dispatch(v.getCompositions())})}getSelectedCities(){return this.citiesCtrl.value.map(n=>Number(n))}getSelectedLocations(){return this.locationsCtrl.value.map(n=>Number(n))}getNewBatch(){this.getCompositions(this.getSelectedCities(),this.getSelectedLocations())}getCompositions(n,o){this.store.dispatch(v.getCompositions({cities:n,locations:o,offset:this.offset}))}goToDetails(n){this.router.navigate(["compositions",n])}openCompositionEditForm(n){let o={editInfo:{id:n.id,code:n.code,location:n.location,type:n.type,status:{value:n.status.id,label:n.status.name},coordinates:n.coordinates,description:n.description}},r=this.dialogService.open(fi,{data:o});this.onDialogClosed(r)}openCompositionCreationForm(){let n=this.dialogService.open(fi);this.onDialogClosed(n)}deleteComposition(n){this.store.dispatch(v.deleteComposition({id:n})),this.offset=0}onDialogClosed(n){n.afterClosed().pipe(Q(1),yt(o=>o===!0)).subscribe(o=>this.offset=0)}};e.\u0275fac=function(o){return new(o||e)(w(R),w(ce),w(dn),w(ge),w(wn),w(ht))},e.\u0275cmp=V({type:e,selectors:[["app-compositions-list"]],viewQuery:function(o,r){if(o&1&&(fn(Et,5),fn(Ua,5),fn(Qa,5)),o&2){let a;un(a=pn())&&(r.viewport=a.first),un(a=pn())&&(r.cityChips=a.first),un(a=pn())&&(r.locationChips=a.first)}},standalone:!0,features:[io,L],decls:17,vars:9,consts:[[1,"wrapper"],[1,"sidebar"],[3,"formGroup"],["label","Locations","placeholder","Location...",3,"options$","itemsCtrl","textCtrl","inputTextChanged","chipsChanged"],["locationChips",""],["label","Cities","placeholder","City...",3,"options$","itemsCtrl","textCtrl","inputTextChanged","chipsChanged"],["cityChips",""],[1,"list"],[1,"heading"],["mat-raised-button","","color","accent",3,"click"],["class","table"],[1,"table"],[1,"columns"],[1,"list-wrapper"],["CdkScrollable","",1,"example-viewport",3,"itemSize","scrolledIndexChange"],["class","row-wrapper",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"row-wrapper"],[1,"row","mat-elevation-z2",3,"click"],[3,"delete","edit"]],template:function(o,r){o&1&&(h(0,"div",0)(1,"mat-card",1)(2,"h2"),g(3,"Filters"),d(),h(4,"form",2)(5,"app-autocomplete-chips",3,4),S("inputTextChanged",function(s){return r.handleLocationInput(s)})("chipsChanged",function(){return r.handleLocationChipsChange()}),d(),h(7,"app-autocomplete-chips",5,6),S("inputTextChanged",function(s){return r.handleCityInput(s)})("chipsChanged",function(){return r.handleCityChipsChange()}),d()()(),h(9,"mat-card",7)(10,"div",8)(11,"h2"),g(12,"Compositions"),d(),h(13,"button",9),S("click",function(){return r.openCompositionCreationForm()}),g(14," Add composition "),d()(),P(15,Za,15,3,"div",10)(16,Wa,1,0),d()()),o&2&&(x(4),y("formGroup",r.sidepanelForm)("@fadeIn",void 0),x(1),y("options$",r.locationOptions$)("itemsCtrl",r.locationsCtrl)("textCtrl",r.locationCtrl),x(2),y("options$",r.cityOptions$)("itemsCtrl",r.citiesCtrl)("textCtrl",r.cityCtrl),x(8),Ct(15,r.compositions!==void 0&&r.compositions.length>0?15:16))},dependencies:[vo,Y,H,st,lt,Pt,ue,fe,Et,Ft,Tt,Nt,At,Mn,Rt],styles:[".row-wrapper[_ngcontent-%COMP%]{margin:0 45px;padding:10px}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{padding:10px 0;background-color:#fff;display:flex;justify-content:space-evenly;align-items:center;border-radius:20px}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;flex:1;text-align:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover{cursor:pointer}.row-wrapper[_ngcontent-%COMP%]   .row.not-operational[_ngcontent-%COMP%]{background-color:#f0b3b3}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{scrollbar-gutter:stable both-edges}.columns[_ngcontent-%COMP%]{margin:0 76px;display:flex;justify-content:space-evenly}.columns[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;flex:1;font-size:20px;font-weight:500;color:#a9a9a9}.wrapper[_ngcontent-%COMP%]{padding:0 5vw;height:100%;display:flex;flex-direction:row}.wrapper[_ngcontent-%COMP%]   .example-viewport[_ngcontent-%COMP%]{min-height:100%}.wrapper[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{flex:1;background-color:#f2f8ef;height:100%;width:100%;overflow-y:hidden;margin-right:15px;padding:30px 20px}.wrapper[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{flex:4;display:flex;flex-direction:column;padding:30px 0;background-color:#f2f8ef;height:100%;width:100%;overflow-y:hidden}.wrapper[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.wrapper[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-wrapper[_ngcontent-%COMP%]{height:100%}.wrapper[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{min-height:100%}.wrapper[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(.example-viewport, .table[_ngcontent-%COMP%], app-no-data)[_ngcontent-%COMP%]{margin-left:45px;margin-right:45px}.wrapper[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:0 15px 20px}"],data:{animation:[gt]},changeDetection:0});let t=e;return t})();var Ja=/^\/compositions$/,In=/^\/compositions\/[\d]+$/,ts={compositions:[],filters:{}},Oo=po(ts,bt(v.getCompositions,(t,{filters:e})=>ft(ut({},t),{filters:e})),bt(v.compositionsFetched,(t,{compositions:e})=>ft(ut({},t),{compositions:[...t.compositions??[],...e]})),bt(v.resetCompositions,v.compositionCreated,v.compositionDeleted,v.compositionEdited,t=>ft(ut({},t),{compositions:[],filters:ft(ut({},t.filters),{offset:0})})),bt(v.detailsFetched,(t,{details:e})=>ft(ut({},t),{details:e})),bt(v.getDeviceDetails,t=>ft(ut({},t),{deviceDetails:void 0})),bt(v.deviceDetailsFetched,(t,{deviceDetails:e})=>ft(ut({},t),{deviceDetails:e})),bt(v.compositionFetched,(t,{composition:e})=>ft(ut({},t),{currentlyViewedComposition:e})),bt(xo,(t,{payload:e})=>es(t,e.event.url)));function es(t,e){return Ja.test(e)?ft(ut({},t),{compositions:[]}):In.test(e)?ft(ut({},t),{currentlyViewedCompositionId:ns(e),currentlyViewedComposition:void 0,details:void 0}):t}function ns(t){let e=t.split("/");return Number(e[e.length-1])}var Do=(()=>{let e=class e{constructor(n,o,r){this.actions$=n,this.compositionService=o,this.store=r,this.loadCompositions=tt(()=>this.actions$.pipe(et(v.getCompositions,v.compositionCreated,v.compositionDeleted,v.compositionEdited),Pe(this.store.select(wo)),A(([a,s])=>this.compositionService.readCompositions(s).pipe(M(l=>v.compositionsFetched({compositions:l})),W(()=>Z))))),this.loadDetails=tt(()=>this.actions$.pipe(et(v.deviceCreated,v.deviceEdited,v.compositionsLinked,v.compositionsUnlinked,v.deleteDevice),Pe(this.store.select(_e)),A(([a,s])=>this.compositionService.readCompositionDetails(s).pipe(M(l=>v.detailsFetched({details:l})),W(()=>Z))))),this.loadDetailsOnNavigation=tt(()=>this.actions$.pipe(et(ci),yt(({payload:a})=>In.test(a.event.url)),Pe(this.store.select(_e)),A(([a,s])=>this.compositionService.readCompositionDetails(s).pipe(M(l=>v.detailsFetched({details:l})),W(()=>Z))))),this.loadCompositionOnNavigation=tt(()=>this.actions$.pipe(et(ci),yt(({payload:a})=>In.test(a.event.url)),Pe(this.store.select(_e)),A(([a,s])=>this.compositionService.readComposition(s).pipe(M(l=>v.compositionFetched({composition:l})),W(()=>Z))))),this.createDevice=tt(()=>this.actions$.pipe(et(v.createDevice),A(({device:a})=>this.compositionService.createDevice(a).pipe(M(()=>v.deviceCreated()),W(()=>Z))))),this.editDevice=tt(()=>this.actions$.pipe(et(v.editDevice),A(({device:a})=>this.compositionService.editDevice(a).pipe(M(()=>v.deviceEdited()),W(()=>Z))))),this.createComposition=tt(()=>this.actions$.pipe(et(v.createComposition),A(({composition:a})=>this.compositionService.createComposition(a).pipe(M(()=>v.compositionCreated()),W(()=>Z))))),this.editComposition=tt(()=>this.actions$.pipe(et(v.editComposition),A(({composition:a})=>this.compositionService.editComposition(a).pipe(M(()=>v.compositionEdited()),W(()=>Z))))),this.deleteComposition=tt(()=>this.actions$.pipe(et(v.deleteComposition),A(({id:a})=>this.compositionService.deleteComposition(a).pipe(M(()=>v.compositionDeleted()),W(()=>Z))))),this.linkCompositions=tt(()=>this.actions$.pipe(et(v.linkCompositions),A(({firstId:a,secondId:s})=>this.compositionService.linkCompositions({firstId:a,secondId:s}).pipe(M(()=>v.compositionsLinked()),W(()=>Z))))),this.unlinkCompositions=tt(()=>this.actions$.pipe(et(v.unlinkCompositions),A(({firstId:a,secondId:s})=>this.compositionService.unlinkCompositions({firstId:a,secondId:s}).pipe(M(()=>v.compositionsUnlinked()),W(()=>Z))))),this.deleteDevice=tt(()=>this.actions$.pipe(et(v.deleteDevice),A(({id:a})=>this.compositionService.deleteDevice(a).pipe(M(()=>v.compositionsUnlinked()),W(()=>Z))))),this.getDeviceDetails=tt(()=>this.actions$.pipe(et(v.getDeviceDetails),A(({id:a})=>this.compositionService.readDeviceDetails(a).pipe(M(s=>v.deviceDetailsFetched({deviceDetails:s})),W(()=>Z)))))}};e.\u0275fac=function(o){return new(o||e)(rn(ho),rn(Vt),rn(R))},e.\u0275prov=no({token:e,factory:e.\u0275fac});let t=e;return t})();function is(t,e){t&1&&(h(0,"mat-error"),g(1,"Code already taken"),d())}function os(t,e){t&1&&(h(0,"mat-error"),g(1,"Name already taken"),d())}var mi=(()=>{let e=class e{uniqueCodeValidator(){return n=>n.valueChanges.pipe(Xt(400),De(),A(o=>this.compositionService.checkIfDeviceCodeExists(this.dialogData.compositionId,o).pipe(M(r=>[r,o]))),M(([o,r])=>o===!0&&!$t(r,this.dialogData.editInfo?.deviceCode)?{deviceCodeExists:!0}:null),Ee(),si(()=>this.changeRef.markForCheck()))}uniqueNameValidator(){return n=>n.valueChanges.pipe(Xt(400),De(),A(o=>this.compositionService.checkIfDeviceNameExists(this.dialogData.compositionId,o).pipe(M(r=>[r,o]))),M(([o,r])=>o===!0&&!$t(r,this.dialogData.editInfo?.deviceName)?{deviceNameExists:!0}:null),Ee(),si(()=>this.changeRef.markForCheck()))}constructor(n,o,r,a){this.store=n,this.injector=o,this.compositionService=r,this.changeRef=a,this.dialogData=this.injector.get(he),this.dialogRef=this.injector.get(de),this.statuses$=new pt([]),this.statusOptions$=this.statuses$.asObservable(),this.statusCtrl=new $(null,[Lt]),this.deviceForm=new wt({deviceCode:new $("",Ne.required,this.uniqueCodeValidator().bind(this)),deviceName:new $("",Ne.required,this.uniqueNameValidator().bind(this)),status:this.statusCtrl});let s=this.dialogData.editInfo!==void 0;this.inEditMode=s,this.actionButtonText=s?"Edit":"Save",this.dialogTitle=s?"Edit device":"Add device"}ngAfterViewInit(){this.dialogData.editInfo!==void 0&&(this.deviceForm.get("status")?.setValue(this.dialogData.editInfo.status),this.deviceForm.get("deviceCode")?.setValue(this.dialogData.editInfo.deviceCode),this.deviceForm.get("deviceName")?.setValue(this.dialogData.editInfo.deviceName),this.deviceForm.markAllAsTouched(),this.deviceForm.updateValueAndValidity())}onStatusInput(n){this.compositionService.readDeviceStatuses({name:n}).pipe(Q(1)).subscribe(o=>this.statuses$.next(o))}get deviceCode(){return this.deviceForm.controls.deviceCode}get deviceName(){return this.deviceForm.controls.deviceName}get deviceStatus(){return this.deviceForm.controls.status}saveOrEditDevice(){this.inEditMode?this.editDevice():this.saveDevice()}saveDevice(){let n=this.dialogData.compositionId,o=this.deviceCode.value,r=this.deviceName.value,a=this.deviceForm.controls.status.value;if(n!==void 0&&o&&r&&it(a)){let s={compositionId:n,deviceCode:o,deviceName:r,statusId:a.value};this.store.dispatch(v.createDevice({device:s})),this.close()}}editDevice(){let n=this.dialogData.compositionId,o=this.deviceCode.value,r=this.deviceName.value,a=this.deviceForm.controls.status.value,s=this.dialogData.editInfo?.deviceId;if(n!==void 0&&o&&r&&s!==void 0&&it(a)){let l={compositionId:n,deviceCode:o,deviceName:r,deviceId:s,statusId:a.value};this.store.dispatch(v.editDevice({device:l})),this.close()}}close(){this.dialogRef.close()}deviceChangedThroughEdit(){if(this.dialogData.editInfo===void 0)return!0;let{deviceCode:n,deviceName:o,status:r}=this.dialogData.editInfo,a=n.toLowerCase()!==this.deviceCode.value?.toLowerCase(),s=o.toLowerCase()!==this.deviceName.value?.toLowerCase(),l=r.value!==me(this.deviceStatus.value);return a||s||l}};e.\u0275fac=function(o){return new(o||e)(w(R),w(ae),w(Vt),w(ht))},e.\u0275cmp=V({type:e,selectors:[["app-device-form"]],standalone:!0,features:[L],decls:20,vars:9,consts:[[1,"example-form",3,"formGroup","ngSubmit"],[1,"example-full-width"],["formControlName","deviceCode","matInput",""],[4,"ngIf"],["formControlName","deviceName","matInput",""],[3,"label","ctrl","options$","userTextInput"],[1,"actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","color","accent","type","submit",3,"disabled"]],template:function(o,r){o&1&&(h(0,"mat-card")(1,"h1"),g(2),d(),h(3,"form",0),S("ngSubmit",function(){return r.saveOrEditDevice()}),h(4,"mat-form-field",1)(5,"mat-label"),g(6,"Device code"),d(),E(7,"input",2),P(8,is,2,0,"mat-error",3),d(),h(9,"mat-form-field",1)(10,"mat-label"),g(11,"Device name"),d(),E(12,"input",4),P(13,os,2,0,"mat-error",3),d(),h(14,"app-single-autocomplete",5),S("userTextInput",function(s){return r.onStatusInput(s)}),d(),h(15,"div",6)(16,"button",7),S("click",function(){return r.close()}),g(17,"Cancel"),d(),h(18,"button",8),g(19),d()()()()),o&2&&(x(2),J(r.dialogTitle),x(1),y("formGroup",r.deviceForm),x(5),y("ngIf",r.deviceCode.hasError("deviceCodeExists")),x(5),y("ngIf",r.deviceName.hasError("deviceNameExists")),x(1),y("label","Device status")("ctrl",r.statusCtrl)("options$",r.statusOptions$),x(4),y("disabled",!r.deviceForm.valid||!r.deviceChangedThroughEdit()),x(1),X(" ",r.actionButtonText," "))},dependencies:[pe,Tt,vn,_n,Nt,H,st,lt,xn,hn,gn,Cn,Ft,At,yn,xe,Y,le],styles:["mat-card[_ngcontent-%COMP%]{padding:20px 16px}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:26px}mat-card[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{display:block}mat-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:space-between}"],changeDetection:0});let t=e;return t})();function rs(t,e){if(t&1){let i=Yt();h(0,"div",8)(1,"div",9),S("click",function(){let r=rt(i).$implicit,a=N(2);return at(a.goToDevice(r.id))}),h(2,"p"),g(3),d(),h(4,"p"),g(5),ln(6,"date"),d(),h(7,"p"),g(8),d(),h(9,"app-list-actions",10),S("edit",function(){let r=rt(i).$implicit,a=N(2);return at(a.openDeviceFormForEdit(r))})("delete",function(){let r=rt(i).$implicit,a=N(2);return at(a.deleteDevice(r.id))}),d()()()}if(t&2){let i=e.$implicit;x(1),se("not-operational",!i.status.isOperational),x(2),J(i.name),x(2),J(cn(6,5,i.creationAt)),x(3),X(" ",i.status.isOperational?"Operational":"Not operational"," ")}}function as(t,e){if(t&1&&(h(0,"div",3)(1,"div",4)(2,"p"),g(3,"Name"),d(),h(4,"p"),g(5,"Added on"),d(),h(6,"p"),g(7,"Status"),d(),h(8,"p"),g(9,"Actions"),d()(),h(10,"div",5)(11,"cdk-virtual-scroll-viewport",6),P(12,rs,10,7,"div",7),d()()()),t&2){let i=N();y("@fadeIn",void 0),x(11),y("itemSize",68),x(1),y("cdkVirtualForOf",i.devices)}}function ss(t,e){t&1&&E(0,"app-no-data")}var Eo=(()=>{let e=class e{constructor(n,o,r){this.store=n,this.router=o,this.dialogService=r}deleteDevice(n){this.store.dispatch(v.deleteDevice({id:n}))}goToDevice(n){this.router.navigate(["compositions/device-details",n])}openDeviceForm(){if(this.compositionId){let n={compositionId:this.compositionId};this.dialogService.open(mi,{data:n})}}openDeviceFormForEdit(n){if(this.compositionId){let o={compositionId:this.compositionId,editInfo:{status:{label:n.status.name,value:n.status.id},deviceName:n.name,deviceCode:n.code,deviceId:n.id}};this.dialogService.open(mi,{data:o})}}};e.\u0275fac=function(o){return new(o||e)(w(R),w(ce),w(ge))},e.\u0275cmp=V({type:e,selectors:[["app-device-list"]],inputs:{compositionId:"compositionId",devices:"devices"},standalone:!0,features:[L],decls:7,vars:1,consts:[[1,"heading"],["mat-raised-button","","color","accent",3,"click"],["class","table"],[1,"table"],[1,"columns"],[1,"list-wrapper"],["CdkScrollable","",3,"itemSize"],["class","row-wrapper",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"row-wrapper"],[1,"row","mat-elevation-z2",3,"click"],[3,"edit","delete"]],template:function(o,r){o&1&&(h(0,"div",0)(1,"h2"),g(2,"Devices"),d(),h(3,"button",1),S("click",function(){return r.openDeviceForm()}),g(4," Add device "),d()(),P(5,as,13,3,"div",2)(6,ss,1,0)),o&2&&(x(5),Ct(5,r.devices!==void 0&&r.devices.length>0?5:6))},dependencies:[H,st,Pt,ue,fe,Et,Y,mn,Mn,Rt],styles:[".row-wrapper[_ngcontent-%COMP%]{margin:0 45px;padding:10px}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{padding:10px 0;background-color:#fff;display:flex;justify-content:space-evenly;align-items:center;border-radius:20px}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;flex:1;text-align:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover{cursor:pointer}.row-wrapper[_ngcontent-%COMP%]   .row.not-operational[_ngcontent-%COMP%]{background-color:#f0b3b3}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{scrollbar-gutter:stable both-edges}.columns[_ngcontent-%COMP%]{margin:0 76px;display:flex;justify-content:space-evenly}.columns[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;flex:1;font-size:20px;font-weight:500;color:#a9a9a9}[_nghost-%COMP%]{padding:0 5vw;padding:30px 0;background-color:#f2f8ef;width:100%;overflow-y:hidden;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .example-viewport[_ngcontent-%COMP%]{min-height:100%}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not(.example-viewport, .table[_ngcontent-%COMP%], app-no-data)[_ngcontent-%COMP%]{margin-left:45px;margin-right:45px}[_nghost-%COMP%]   .table[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .list-wrapper[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{min-height:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:0 15px 20px}"],data:{animation:[gt]},changeDetection:0});let t=e;return t})();var Po=(()=>{let e=class e{constructor(n,o,r){this.store=n,this.injector=o,this.service=r,this.dialogData=this.injector.get(he),this.dialogRef=this.injector.get(de),this.compositionTypes$=new pt([]),this.options$=this.compositionTypes$.asObservable(),this.nameCtrl=new $("",[Lt]),this.form=new wt({nameCtrl:this.nameCtrl})}onUserInput(n){let{cities:o,excludedCompositions:r}=this.dialogData;this.service.readCompositions({cities:o,excludedCompositions:r,code:n}).pipe(M(a=>a.map(s=>this.getLabeledValueForComposition(s))),Q(1)).subscribe(a=>this.compositionTypes$.next(a))}linkCompositions(){let n=this.form.get("nameCtrl")?.value;it(n)&&this.store.dispatch(v.linkCompositions({firstId:this.dialogData.compositionId,secondId:n.value})),this.dialogRef.close()}getLabeledValueForComposition(n){return{label:`${n.code} (${n.location.label})`,value:n.id}}};e.\u0275fac=function(o){return new(o||e)(w(R),w(ae),w(Vt))},e.\u0275cmp=V({type:e,selectors:[["app-link-composition-form"]],standalone:!0,features:[L],decls:8,vars:5,consts:[[3,"formGroup"],[3,"label","ctrl","options$","userTextInput"],[1,"actions"],["mat-raised-button","","color","accent",3,"disabled","click"]],template:function(o,r){o&1&&(h(0,"mat-card")(1,"form",0)(2,"h1"),g(3,"Link composition"),d(),h(4,"app-single-autocomplete",1),S("userTextInput",function(s){return r.onUserInput(s)}),d(),h(5,"div",2)(6,"button",3),S("click",function(){return r.linkCompositions()}),g(7," Link "),d()()()()),o&2&&(x(1),y("formGroup",r.form),x(3),y("label","Composition")("ctrl",r.nameCtrl)("options$",r.options$),x(2),y("disabled",r.form.invalid))},dependencies:[Y,xe,H,st,lt,pe,Tt,Nt,Ft,At],styles:["mat-card[_ngcontent-%COMP%]{padding:20px 16px;width:400px}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:26px}mat-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:space-between}"],changeDetection:0});let t=e;return t})();function ls(t,e){if(t&1){let i=Yt();h(0,"div",8)(1,"div",9),S("click",function(){let r=rt(i).$implicit,a=N(2);return at(a.goToComposition(r.id))}),h(2,"p"),g(3),d(),h(4,"p"),g(5),d(),h(6,"p"),g(7),d(),h(8,"div",10)(9,"button",11),S("click",function(){let r=rt(i).$implicit,a=N(2);return at(a.unlinkCompositions(r.id))}),h(10,"mat-icon"),g(11,"phonelink_off"),d()()()()()}if(t&2){let i=e.$implicit;x(1),se("not-operational",!i.status.isOperational),x(2),J(i.code),x(2),J(i.devicesSize),x(2),X(" ",i.status.isOperational?"Operational":"Not operational"," ")}}function cs(t,e){if(t&1&&(h(0,"div",3)(1,"div",4)(2,"p"),g(3,"Code"),d(),h(4,"p"),g(5,"Devices"),d(),h(6,"p"),g(7,"Status"),d(),h(8,"p"),g(9,"Actions"),d()(),h(10,"div",5)(11,"cdk-virtual-scroll-viewport",6),P(12,ls,12,5,"div",7),d()()()),t&2){let i=N();y("@fadeIn",void 0),x(11),y("itemSize",60),x(1),y("cdkVirtualForOf",i.linkedCompositions)}}function us(t,e){t&1&&E(0,"app-no-data")}var No=(()=>{let e=class e{constructor(n,o,r){this.store=n,this.router=o,this.dialogService=r}openLinkCompositionForm(){if(this.linkedCompositions===void 0||this.composition===void 0)return;let n=this.linkedCompositions.map(a=>a.id),o=this.composition.id,r={compositionId:o,cities:[this.composition.city.value],excludedCompositions:[o,...n]};this.dialogService.open(Po,{data:r})}unlinkCompositions(n){this.composition!==void 0&&this.store.dispatch(v.unlinkCompositions({firstId:this.composition.id,secondId:n}))}goToComposition(n){this.router.navigate(["compositions",n])}};e.\u0275fac=function(o){return new(o||e)(w(R),w(ce),w(ge))},e.\u0275cmp=V({type:e,selectors:[["app-linked-composition-list"]],inputs:{composition:"composition",linkedCompositions:"linkedCompositions"},standalone:!0,features:[L],decls:7,vars:1,consts:[[1,"heading"],["mat-raised-button","","color","accent",3,"click"],["class","table"],[1,"table"],[1,"columns"],[1,"list-wrapper"],["CdkScrollable","",1,"example-viewport",3,"itemSize"],["class","row-wrapper",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"row-wrapper"],[1,"row","mat-elevation-z2",3,"click"],[1,"action-buttons"],["mat-icon-button","","color","warn",3,"click"]],template:function(o,r){o&1&&(h(0,"div",0)(1,"h2"),g(2,"Linked compositions"),d(),h(3,"button",1),S("click",function(){return r.openLinkCompositionForm()}),g(4," Link composition "),d()(),P(5,cs,13,3,"div",2)(6,us,1,0)),o&2&&(x(5),Ct(5,r.linkedCompositions!==void 0&&r.linkedCompositions.length>0?5:6))},dependencies:[H,st,ao,so,Pt,ue,fe,Et,Y,Rt],styles:[".row-wrapper[_ngcontent-%COMP%]{margin:0 45px;padding:10px}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{padding:10px 0;background-color:#fff;display:flex;justify-content:space-evenly;align-items:center;border-radius:20px}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;flex:1;text-align:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.row-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover{cursor:pointer}.row-wrapper[_ngcontent-%COMP%]   .row.not-operational[_ngcontent-%COMP%]{background-color:#f0b3b3}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{scrollbar-gutter:stable both-edges}.columns[_ngcontent-%COMP%]{margin:0 76px;display:flex;justify-content:space-evenly}.columns[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;flex:1;font-size:20px;font-weight:500;color:#a9a9a9}[_nghost-%COMP%]{padding:0 5vw;padding:30px 0;background-color:#f2f8ef;width:100%;overflow-y:hidden;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .example-viewport[_ngcontent-%COMP%]{min-height:100%}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not(.example-viewport, .table[_ngcontent-%COMP%], app-no-data)[_ngcontent-%COMP%]{margin-left:45px;margin-right:45px}[_nghost-%COMP%]   .table[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .list-wrapper[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{min-height:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:0 15px 20px}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:inline-block;flex:1;display:flex;justify-content:center}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-top:-10px;margin-bottom:-10px}"],data:{animation:[gt]},changeDetection:0});let t=e;return t})();function fs(t,e){if(t&1&&(h(0,"h2"),g(1),d()),t&2){let i=N();y("@fadeIn",void 0),x(1),oo(" Details for ",i.currentComposition.code," (",i.currentComposition.city.label,", ",i.currentComposition.location.label,") ")}}function ps(t,e){if(t&1&&(h(0,"div",3)(1,"mat-card",4),E(2,"app-device-list",5),d(),h(3,"mat-card",6),E(4,"app-linked-composition-list",7),d()()),t&2){let i=N();x(2),y("compositionId",i.compositionId)("devices",i.details.devices),x(2),y("composition",i.currentComposition)("linkedCompositions",i.details.relatedCompositions)}}var To=(()=>{let e=class e{constructor(n,o){this.store=n,this.changeRef=o,this.destroyRef=an(sn)}ngOnInit(){this.store.select(_e).pipe(Ht(this.destroyRef)).subscribe(n=>{this.compositionId=n,this.changeRef.markForCheck()}),this.store.select(Co).pipe(Ht(this.destroyRef)).subscribe(n=>{this.details=n,this.changeRef.markForCheck()}),this.store.select(Mo).pipe(Ht(this.destroyRef)).subscribe(n=>{this.currentComposition=n,this.changeRef.markForCheck()})}};e.\u0275fac=function(o){return new(o||e)(w(R),w(ht))},e.\u0275cmp=V({type:e,selectors:[["app-composition-details"]],standalone:!0,features:[L],decls:3,vars:2,consts:[[1,"details"],[4,"ngIf"],["class","lists",4,"ngIf"],[1,"lists"],[1,"devices"],[3,"compositionId","devices"],[1,"related-compositions"],[3,"composition","linkedCompositions"]],template:function(o,r){o&1&&(h(0,"mat-card",0),P(1,fs,2,4,"h2",1),d(),P(2,ps,5,4,"div",2)),o&2&&(x(1),y("ngIf",r.currentComposition),x(1),y("ngIf",r.details))},dependencies:[Y,le,H,lt,Pt,Eo,No],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:0 5vw;height:100%}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]{flex:1;justify-content:center;margin-bottom:20px;background-color:#f2f8ef}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:0;margin-left:15px}[_nghost-%COMP%]   .lists[_ngcontent-%COMP%]{flex:7;display:flex}[_nghost-%COMP%]   .lists[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]:first-child{margin-right:15px}[_nghost-%COMP%]   .lists[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]:last-child{margin-left:15px}[_nghost-%COMP%]   .lists[_ngcontent-%COMP%]   .devices[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .lists[_ngcontent-%COMP%]   .related-compositions[_ngcontent-%COMP%]{flex:1}"],data:{animation:[gt]},changeDetection:0});let t=e;return t})();function Qt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function di(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function On(t){let e,i,n;t.length!==2?(e=Qt,i=(s,l)=>Qt(t(s),l),n=(s,l)=>t(s)-l):(e=t===Qt||t===di?t:ms,i=t,n=t);function o(s,l,c=0,u=s.length){if(c<u){if(e(l,l)!==0)return u;do{let f=c+u>>>1;i(s[f],l)<0?c=f+1:u=f}while(c<u)}return c}function r(s,l,c=0,u=s.length){if(c<u){if(e(l,l)!==0)return u;do{let f=c+u>>>1;i(s[f],l)<=0?c=f+1:u=f}while(c<u)}return c}function a(s,l,c=0,u=s.length){let f=o(s,l,c,u-1);return f>c&&n(s[f-1],l)>-n(s[f],l)?f-1:f}return{left:o,center:a,right:r}}function ms(){return 0}function hi(t){return t===null?NaN:+t}var Ao=On(Qt),Fo=Ao.right,ds=Ao.left,hs=On(hi).center,gi=Fo;var ye=class extends Map{constructor(e,i=vs){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),e!=null)for(let[n,o]of e)this.set(n,o)}get(e){return super.get(Vo(this,e))}has(e){return super.has(Vo(this,e))}set(e,i){return super.set(gs(this,e),i)}delete(e){return super.delete(xs(this,e))}};function Vo({_intern:t,_key:e},i){let n=e(i);return t.has(n)?t.get(n):i}function gs({_intern:t,_key:e},i){let n=e(i);return t.has(n)?t.get(n):(t.set(n,i),i)}function xs({_intern:t,_key:e},i){let n=e(i);return t.has(n)&&(i=t.get(n),t.delete(n)),i}function vs(t){return t!==null&&typeof t=="object"?t.valueOf():t}var _s=Math.sqrt(50),ys=Math.sqrt(10),Cs=Math.sqrt(2);function Dn(t,e,i){let n=(e-t)/Math.max(0,i),o=Math.floor(Math.log10(n)),r=n/Math.pow(10,o),a=r>=_s?10:r>=ys?5:r>=Cs?2:1,s,l,c;return o<0?(c=Math.pow(10,-o)/a,s=Math.round(t*c),l=Math.round(e*c),s/c<t&&++s,l/c>e&&--l,c=-c):(c=Math.pow(10,o)*a,s=Math.round(t/c),l=Math.round(e/c),s*c<t&&++s,l*c>e&&--l),l<s&&.5<=i&&i<2?Dn(t,e,i*2):[s,l,c]}function En(t,e,i){if(e=+e,t=+t,i=+i,!(i>0))return[];if(t===e)return[t];let n=e<t,[o,r,a]=n?Dn(e,t,i):Dn(t,e,i);if(!(r>=o))return[];let s=r-o+1,l=new Array(s);if(n)if(a<0)for(let c=0;c<s;++c)l[c]=(r-c)/-a;else for(let c=0;c<s;++c)l[c]=(r-c)*a;else if(a<0)for(let c=0;c<s;++c)l[c]=(o+c)/-a;else for(let c=0;c<s;++c)l[c]=(o+c)*a;return l}function Fe(t,e,i){return e=+e,t=+t,i=+i,Dn(t,e,i)[2]}function xi(t,e,i){e=+e,t=+t,i=+i;let n=e<t,o=n?Fe(e,t,i):Fe(t,e,i);return(n?-1:1)*(o<0?1/-o:o)}function Ce(t,e,i){t=+t,e=+e,i=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+i;for(var n=-1,o=Math.max(0,Math.ceil((e-t)/i))|0,r=new Array(o);++n<o;)r[n]=t+n*i;return r}function Lo(t){return t}var vi=1,_i=2,yi=3,Ve=4,$o=1e-6;function ws(t){return"translate("+t+",0)"}function bs(t){return"translate(0,"+t+")"}function Ms(t){return e=>+t(e)}function Ss(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),i=>+t(i)+e}function ks(){return!this.__axis}function Ro(t,e){var i=[],n=null,o=null,r=6,a=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=t===vi||t===Ve?-1:1,u=t===Ve||t===_i?"x":"y",f=t===vi||t===yi?ws:bs;function p(m){var _=n??(e.ticks?e.ticks.apply(e,i):e.domain()),b=o??(e.tickFormat?e.tickFormat.apply(e,i):Lo),I=Math.max(r,0)+s,U=e.range(),G=+U[0]+l,T=+U[U.length-1]+l,ot=(e.bandwidth?Ss:Ms)(e.copy(),l),D=m.selection?m.selection():m,Ot=D.selectAll(".domain").data([null]),ct=D.selectAll(".tick").data(_,e).order(),ie=ct.exit(),oe=ct.enter().append("g").attr("class","tick"),Dt=ct.select("line"),C=ct.select("text");Ot=Ot.merge(Ot.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ct=ct.merge(oe),Dt=Dt.merge(oe.append("line").attr("stroke","currentColor").attr(u+"2",c*r)),C=C.merge(oe.append("text").attr("fill","currentColor").attr(u,c*I).attr("dy",t===vi?"0em":t===yi?"0.71em":"0.32em")),m!==D&&(Ot=Ot.transition(m),ct=ct.transition(m),Dt=Dt.transition(m),C=C.transition(m),ie=ie.transition(m).attr("opacity",$o).attr("transform",function(j){return isFinite(j=ot(j))?f(j+l):this.getAttribute("transform")}),oe.attr("opacity",$o).attr("transform",function(j){var z=this.parentNode.__axis;return f((z&&isFinite(z=z(j))?z:ot(j))+l)})),ie.remove(),Ot.attr("d",t===Ve||t===_i?a?"M"+c*a+","+G+"H"+l+"V"+T+"H"+c*a:"M"+l+","+G+"V"+T:a?"M"+G+","+c*a+"V"+l+"H"+T+"V"+c*a:"M"+G+","+l+"H"+T),ct.attr("opacity",1).attr("transform",function(j){return f(ot(j)+l)}),Dt.attr(u+"2",c*r),C.attr(u,c*I).text(b),D.filter(ks).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===_i?"start":t===Ve?"end":"middle"),D.each(function(){this.__axis=ot})}return p.scale=function(m){return arguments.length?(e=m,p):e},p.ticks=function(){return i=Array.from(arguments),p},p.tickArguments=function(m){return arguments.length?(i=m==null?[]:Array.from(m),p):i.slice()},p.tickValues=function(m){return arguments.length?(n=m==null?null:Array.from(m),p):n&&n.slice()},p.tickFormat=function(m){return arguments.length?(o=m,p):o},p.tickSize=function(m){return arguments.length?(r=a=+m,p):r},p.tickSizeInner=function(m){return arguments.length?(r=+m,p):r},p.tickSizeOuter=function(m){return arguments.length?(a=+m,p):a},p.tickPadding=function(m){return arguments.length?(s=+m,p):s},p.offset=function(m){return arguments.length?(l=+m,p):l},p}function Ci(t){return Ro(yi,t)}function wi(t){return Ro(Ve,t)}var Is={value:()=>{}};function qo(){for(var t=0,e=arguments.length,i={},n;t<e;++t){if(!(n=arguments[t]+"")||n in i||/[\s.]/.test(n))throw new Error("illegal type: "+n);i[n]=[]}return new Pn(i)}function Pn(t){this._=t}function Os(t,e){return t.trim().split(/^|\s+/).map(function(i){var n="",o=i.indexOf(".");if(o>=0&&(n=i.slice(o+1),i=i.slice(0,o)),i&&!e.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:n}})}Pn.prototype=qo.prototype={constructor:Pn,on:function(t,e){var i=this._,n=Os(t+"",i),o,r=-1,a=n.length;if(arguments.length<2){for(;++r<a;)if((o=(t=n[r]).type)&&(o=Ds(i[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++r<a;)if(o=(t=n[r]).type)i[o]=zo(i[o],t.name,e);else if(e==null)for(o in i)i[o]=zo(i[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new Pn(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var i=new Array(o),n=0,o,r;n<o;++n)i[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=this._[t],n=0,o=r.length;n<o;++n)r[n].value.apply(e,i)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,r=n.length;o<r;++o)n[o].value.apply(e,i)}};function Ds(t,e){for(var i=0,n=t.length,o;i<n;++i)if((o=t[i]).name===e)return o.value}function zo(t,e,i){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=Is,t=t.slice(0,n).concat(t.slice(n+1));break}return i!=null&&t.push({name:e,value:i}),t}var bi=qo;var Nn="http://www.w3.org/1999/xhtml",Mi={svg:"http://www.w3.org/2000/svg",xhtml:Nn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function St(t){var e=t+="",i=e.indexOf(":");return i>=0&&(e=t.slice(0,i))!=="xmlns"&&(t=t.slice(i+1)),Mi.hasOwnProperty(e)?{space:Mi[e],local:t}:t}function Es(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===Nn&&e.documentElement.namespaceURI===Nn?e.createElement(t):e.createElementNS(i,t)}}function Ps(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Tn(t){var e=St(t);return(e.local?Ps:Es)(e)}function Ns(){}function Kt(t){return t==null?Ns:function(){return this.querySelector(t)}}function Bo(t){typeof t!="function"&&(t=Kt(t));for(var e=this._groups,i=e.length,n=new Array(i),o=0;o<i;++o)for(var r=e[o],a=r.length,s=n[o]=new Array(a),l,c,u=0;u<a;++u)(l=r[u])&&(c=t.call(l,l.__data__,u,r))&&("__data__"in l&&(c.__data__=l.__data__),s[u]=c);return new O(n,this._parents)}function Si(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ts(){return[]}function Le(t){return t==null?Ts:function(){return this.querySelectorAll(t)}}function As(t){return function(){return Si(t.apply(this,arguments))}}function Go(t){typeof t=="function"?t=As(t):t=Le(t);for(var e=this._groups,i=e.length,n=[],o=[],r=0;r<i;++r)for(var a=e[r],s=a.length,l,c=0;c<s;++c)(l=a[c])&&(n.push(t.call(l,l.__data__,c,a)),o.push(l));return new O(n,o)}function $e(t){return function(){return this.matches(t)}}function An(t){return function(e){return e.matches(t)}}var Fs=Array.prototype.find;function Vs(t){return function(){return Fs.call(this.children,t)}}function Ls(){return this.firstElementChild}function jo(t){return this.select(t==null?Ls:Vs(typeof t=="function"?t:An(t)))}var $s=Array.prototype.filter;function Rs(){return Array.from(this.children)}function zs(t){return function(){return $s.call(this.children,t)}}function Xo(t){return this.selectAll(t==null?Rs:zs(typeof t=="function"?t:An(t)))}function Yo(t){typeof t!="function"&&(t=$e(t));for(var e=this._groups,i=e.length,n=new Array(i),o=0;o<i;++o)for(var r=e[o],a=r.length,s=n[o]=[],l,c=0;c<a;++c)(l=r[c])&&t.call(l,l.__data__,c,r)&&s.push(l);return new O(n,this._parents)}function Fn(t){return new Array(t.length)}function Ho(){return new O(this._enter||this._groups.map(Fn),this._parents)}function Re(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Re.prototype={constructor:Re,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Uo(t){return function(){return t}}function qs(t,e,i,n,o,r){for(var a=0,s,l=e.length,c=r.length;a<c;++a)(s=e[a])?(s.__data__=r[a],n[a]=s):i[a]=new Re(t,r[a]);for(;a<l;++a)(s=e[a])&&(o[a]=s)}function Bs(t,e,i,n,o,r,a){var s,l,c=new Map,u=e.length,f=r.length,p=new Array(u),m;for(s=0;s<u;++s)(l=e[s])&&(p[s]=m=a.call(l,l.__data__,s,e)+"",c.has(m)?o[s]=l:c.set(m,l));for(s=0;s<f;++s)m=a.call(t,r[s],s,r)+"",(l=c.get(m))?(n[s]=l,l.__data__=r[s],c.delete(m)):i[s]=new Re(t,r[s]);for(s=0;s<u;++s)(l=e[s])&&c.get(p[s])===l&&(o[s]=l)}function Gs(t){return t.__data__}function Qo(t,e){if(!arguments.length)return Array.from(this,Gs);var i=e?Bs:qs,n=this._parents,o=this._groups;typeof t!="function"&&(t=Uo(t));for(var r=o.length,a=new Array(r),s=new Array(r),l=new Array(r),c=0;c<r;++c){var u=n[c],f=o[c],p=f.length,m=js(t.call(u,u&&u.__data__,c,n)),_=m.length,b=s[c]=new Array(_),I=a[c]=new Array(_),U=l[c]=new Array(p);i(u,f,b,I,U,m,e);for(var G=0,T=0,ot,D;G<_;++G)if(ot=b[G]){for(G>=T&&(T=G+1);!(D=I[T])&&++T<_;);ot._next=D||null}}return a=new O(a,n),a._enter=s,a._exit=l,a}function js(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ko(){return new O(this._exit||this._groups.map(Fn),this._parents)}function Zo(t,e,i){var n=this.enter(),o=this,r=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),i==null?r.remove():i(r),n&&o?n.merge(o).order():o}function Wo(t){for(var e=t.selection?t.selection():t,i=this._groups,n=e._groups,o=i.length,r=n.length,a=Math.min(o,r),s=new Array(o),l=0;l<a;++l)for(var c=i[l],u=n[l],f=c.length,p=s[l]=new Array(f),m,_=0;_<f;++_)(m=c[_]||u[_])&&(p[_]=m);for(;l<o;++l)s[l]=i[l];return new O(s,this._parents)}function Jo(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n=t[e],o=n.length-1,r=n[o],a;--o>=0;)(a=n[o])&&(r&&a.compareDocumentPosition(r)^4&&r.parentNode.insertBefore(a,r),r=a);return this}function tr(t){t||(t=Xs);function e(f,p){return f&&p?t(f.__data__,p.__data__):!f-!p}for(var i=this._groups,n=i.length,o=new Array(n),r=0;r<n;++r){for(var a=i[r],s=a.length,l=o[r]=new Array(s),c,u=0;u<s;++u)(c=a[u])&&(l[u]=c);l.sort(e)}return new O(o,this._parents).order()}function Xs(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function er(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function nr(){return Array.from(this)}function ir(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],o=0,r=n.length;o<r;++o){var a=n[o];if(a)return a}return null}function or(){let t=0;for(let e of this)++t;return t}function rr(){return!this.node()}function ar(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var o=e[i],r=0,a=o.length,s;r<a;++r)(s=o[r])&&t.call(s,s.__data__,r,o);return this}function Ys(t){return function(){this.removeAttribute(t)}}function Hs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Us(t,e){return function(){this.setAttribute(t,e)}}function Qs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ks(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttribute(t):this.setAttribute(t,i)}}function Zs(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function sr(t,e){var i=St(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((e==null?i.local?Hs:Ys:typeof e=="function"?i.local?Zs:Ks:i.local?Qs:Us)(i,e))}function Vn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ws(t){return function(){this.style.removeProperty(t)}}function Js(t,e,i){return function(){this.style.setProperty(t,e,i)}}function tl(t,e,i){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function lr(t,e,i){return arguments.length>1?this.each((e==null?Ws:typeof e=="function"?tl:Js)(t,e,i??"")):qt(this.node(),t)}function qt(t,e){return t.style.getPropertyValue(e)||Vn(t).getComputedStyle(t,null).getPropertyValue(e)}function el(t){return function(){delete this[t]}}function nl(t,e){return function(){this[t]=e}}function il(t,e){return function(){var i=e.apply(this,arguments);i==null?delete this[t]:this[t]=i}}function cr(t,e){return arguments.length>1?this.each((e==null?el:typeof e=="function"?il:nl)(t,e)):this.node()[t]}function ur(t){return t.trim().split(/^|\s+/)}function ki(t){return t.classList||new fr(t)}function fr(t){this._node=t,this._names=ur(t.getAttribute("class")||"")}fr.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function pr(t,e){for(var i=ki(t),n=-1,o=e.length;++n<o;)i.add(e[n])}function mr(t,e){for(var i=ki(t),n=-1,o=e.length;++n<o;)i.remove(e[n])}function ol(t){return function(){pr(this,t)}}function rl(t){return function(){mr(this,t)}}function al(t,e){return function(){(e.apply(this,arguments)?pr:mr)(this,t)}}function dr(t,e){var i=ur(t+"");if(arguments.length<2){for(var n=ki(this.node()),o=-1,r=i.length;++o<r;)if(!n.contains(i[o]))return!1;return!0}return this.each((typeof e=="function"?al:e?ol:rl)(i,e))}function sl(){this.textContent=""}function ll(t){return function(){this.textContent=t}}function cl(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function hr(t){return arguments.length?this.each(t==null?sl:(typeof t=="function"?cl:ll)(t)):this.node().textContent}function ul(){this.innerHTML=""}function fl(t){return function(){this.innerHTML=t}}function pl(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function gr(t){return arguments.length?this.each(t==null?ul:(typeof t=="function"?pl:fl)(t)):this.node().innerHTML}function ml(){this.nextSibling&&this.parentNode.appendChild(this)}function xr(){return this.each(ml)}function dl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function vr(){return this.each(dl)}function _r(t){var e=typeof t=="function"?t:Tn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function hl(){return null}function yr(t,e){var i=typeof t=="function"?t:Tn(t),n=e==null?hl:typeof e=="function"?e:Kt(e);return this.select(function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)})}function gl(){var t=this.parentNode;t&&t.removeChild(this)}function Cr(){return this.each(gl)}function xl(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vl(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wr(t){return this.select(t?vl:xl)}function br(t){return arguments.length?this.property("__data__",t):this.node().__data__}function _l(t){return function(e){t.call(this,e,this.__data__)}}function yl(t){return t.trim().split(/^|\s+/).map(function(e){var i="",n=e.indexOf(".");return n>=0&&(i=e.slice(n+1),e=e.slice(0,n)),{type:e,name:i}})}function Cl(t){return function(){var e=this.__on;if(e){for(var i=0,n=-1,o=e.length,r;i<o;++i)r=e[i],(!t.type||r.type===t.type)&&r.name===t.name?this.removeEventListener(r.type,r.listener,r.options):e[++n]=r;++n?e.length=n:delete this.__on}}}function wl(t,e,i){return function(){var n=this.__on,o,r=_l(e);if(n){for(var a=0,s=n.length;a<s;++a)if((o=n[a]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=r,o.options=i),o.value=e;return}}this.addEventListener(t.type,r,i),o={type:t.type,name:t.name,value:e,listener:r,options:i},n?n.push(o):this.__on=[o]}}function Mr(t,e,i){var n=yl(t+""),o,r=n.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,c=s.length,u;l<c;++l)for(o=0,u=s[l];o<r;++o)if((a=n[o]).type===u.type&&a.name===u.name)return u.value}return}for(s=e?wl:Cl,o=0;o<r;++o)this.each(s(n[o],e,i));return this}function Sr(t,e,i){var n=Vn(t),o=n.CustomEvent;typeof o=="function"?o=new o(e,i):(o=n.document.createEvent("Event"),i?(o.initEvent(e,i.bubbles,i.cancelable),o.detail=i.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function bl(t,e){return function(){return Sr(this,t,e)}}function Ml(t,e){return function(){return Sr(this,t,e.apply(this,arguments))}}function kr(t,e){return this.each((typeof e=="function"?Ml:bl)(t,e))}function*Ir(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],o=0,r=n.length,a;o<r;++o)(a=n[o])&&(yield a)}var Ii=[null];function O(t,e){this._groups=t,this._parents=e}function Or(){return new O([[document.documentElement]],Ii)}function Sl(){return this}O.prototype=Or.prototype={constructor:O,select:Bo,selectAll:Go,selectChild:jo,selectChildren:Xo,filter:Yo,data:Qo,enter:Ho,exit:Ko,join:Zo,merge:Wo,selection:Sl,order:Jo,sort:tr,call:er,nodes:nr,node:ir,size:or,empty:rr,each:ar,attr:sr,style:lr,property:cr,classed:dr,text:hr,html:gr,raise:xr,lower:vr,append:_r,insert:yr,remove:Cr,clone:wr,datum:br,on:Mr,dispatch:kr,[Symbol.iterator]:Ir};var kt=Or;function Oi(t){return typeof t=="string"?new O([[document.querySelector(t)]],[document.documentElement]):new O([[t]],Ii)}function Ln(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function Di(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function Be(){}var ze=.7,zn=1/ze,we="\\s*([+-]?\\d+)\\s*",qe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kl=/^#([0-9a-f]{3,8})$/,Il=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),Ol=new RegExp(`^rgb\\(${xt},${xt},${xt}\\)$`),Dl=new RegExp(`^rgba\\(${we},${we},${we},${qe}\\)$`),El=new RegExp(`^rgba\\(${xt},${xt},${xt},${qe}\\)$`),Pl=new RegExp(`^hsl\\(${qe},${xt},${xt}\\)$`),Nl=new RegExp(`^hsla\\(${qe},${xt},${xt},${qe}\\)$`),Dr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ln(Be,dt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Er,formatHex:Er,formatHex8:Tl,formatHsl:Al,formatRgb:Pr,toString:Pr});function Er(){return this.rgb().formatHex()}function Tl(){return this.rgb().formatHex8()}function Al(){return Lr(this).formatHsl()}function Pr(){return this.rgb().formatRgb()}function dt(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=kl.exec(t))?(i=e[1].length,e=parseInt(e[1],16),i===6?Nr(e):i===3?new nt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):i===8?$n(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):i===4?$n(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Il.exec(t))?new nt(e[1],e[2],e[3],1):(e=Ol.exec(t))?new nt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Dl.exec(t))?$n(e[1],e[2],e[3],e[4]):(e=El.exec(t))?$n(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Pl.exec(t))?Fr(e[1],e[2]/100,e[3]/100,1):(e=Nl.exec(t))?Fr(e[1],e[2]/100,e[3]/100,e[4]):Dr.hasOwnProperty(t)?Nr(Dr[t]):t==="transparent"?new nt(NaN,NaN,NaN,0):null}function Nr(t){return new nt(t>>16&255,t>>8&255,t&255,1)}function $n(t,e,i,n){return n<=0&&(t=e=i=NaN),new nt(t,e,i,n)}function Fl(t){return t instanceof Be||(t=dt(t)),t?(t=t.rgb(),new nt(t.r,t.g,t.b,t.opacity)):new nt}function be(t,e,i,n){return arguments.length===1?Fl(t):new nt(t,e,i,n??1)}function nt(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}Ln(nt,be,Di(Be,{brighter(t){return t=t==null?zn:Math.pow(zn,t),new nt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ze:Math.pow(ze,t),new nt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new nt(Wt(this.r),Wt(this.g),Wt(this.b),qn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tr,formatHex:Tr,formatHex8:Vl,formatRgb:Ar,toString:Ar}));function Tr(){return`#${Zt(this.r)}${Zt(this.g)}${Zt(this.b)}`}function Vl(){return`#${Zt(this.r)}${Zt(this.g)}${Zt(this.b)}${Zt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ar(){let t=qn(this.opacity);return`${t===1?"rgb(":"rgba("}${Wt(this.r)}, ${Wt(this.g)}, ${Wt(this.b)}${t===1?")":`, ${t})`}`}function qn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Wt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Zt(t){return t=Wt(t),(t<16?"0":"")+t.toString(16)}function Fr(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new mt(t,e,i,n)}function Lr(t){if(t instanceof mt)return new mt(t.h,t.s,t.l,t.opacity);if(t instanceof Be||(t=dt(t)),!t)return new mt;if(t instanceof mt)return t;t=t.rgb();var e=t.r/255,i=t.g/255,n=t.b/255,o=Math.min(e,i,n),r=Math.max(e,i,n),a=NaN,s=r-o,l=(r+o)/2;return s?(e===r?a=(i-n)/s+(i<n)*6:i===r?a=(n-e)/s+2:a=(e-i)/s+4,s/=l<.5?r+o:2-r-o,a*=60):s=l>0&&l<1?0:a,new mt(a,s,l,t.opacity)}function $r(t,e,i,n){return arguments.length===1?Lr(t):new mt(t,e,i,n??1)}function mt(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}Ln(mt,$r,Di(Be,{brighter(t){return t=t==null?zn:Math.pow(zn,t),new mt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ze:Math.pow(ze,t),new mt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,o=2*i-n;return new nt(Ei(t>=240?t-240:t+120,o,n),Ei(t,o,n),Ei(t<120?t+240:t-120,o,n),this.opacity)},clamp(){return new mt(Vr(this.h),Rn(this.s),Rn(this.l),qn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=qn(this.opacity);return`${t===1?"hsl(":"hsla("}${Vr(this.h)}, ${Rn(this.s)*100}%, ${Rn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Vr(t){return t=(t||0)%360,t<0?t+360:t}function Rn(t){return Math.max(0,Math.min(1,t||0))}function Ei(t,e,i){return(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)*255}function Pi(t,e,i,n,o){var r=t*t,a=r*t;return((1-3*t+3*r-a)*e+(4-6*r+3*a)*i+(1+3*t+3*r-3*a)*n+a*o)/6}function Rr(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),o=t[n],r=t[n+1],a=n>0?t[n-1]:2*o-r,s=n<e-1?t[n+2]:2*r-o;return Pi((i-n/e)*e,a,o,r,s)}}function zr(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e),o=t[(n+e-1)%e],r=t[n%e],a=t[(n+1)%e],s=t[(n+2)%e];return Pi((i-n/e)*e,o,r,a,s)}}var Ge=t=>()=>t;function Ll(t,e){return function(i){return t+i*e}}function $l(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}function qr(t){return(t=+t)==1?Bn:function(e,i){return i-e?$l(e,i,t):Ge(isNaN(e)?i:e)}}function Bn(t,e){var i=e-t;return i?Ll(t,i):Ge(isNaN(t)?e:t)}var Jt=function t(e){var i=qr(e);function n(o,r){var a=i((o=be(o)).r,(r=be(r)).r),s=i(o.g,r.g),l=i(o.b,r.b),c=Bn(o.opacity,r.opacity);return function(u){return o.r=a(u),o.g=s(u),o.b=l(u),o.opacity=c(u),o+""}}return n.gamma=t,n}(1);function Br(t){return function(e){var i=e.length,n=new Array(i),o=new Array(i),r=new Array(i),a,s;for(a=0;a<i;++a)s=be(e[a]),n[a]=s.r||0,o[a]=s.g||0,r[a]=s.b||0;return n=t(n),o=t(o),r=t(r),s.opacity=1,function(l){return s.r=n(l),s.g=o(l),s.b=r(l),s+""}}}var Rl=Br(Rr),zl=Br(zr);function Gr(t,e){e||(e=[]);var i=t?Math.min(e.length,t.length):0,n=e.slice(),o;return function(r){for(o=0;o<i;++o)n[o]=t[o]*(1-r)+e[o]*r;return n}}function jr(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Xr(t,e){var i=e?e.length:0,n=t?Math.min(i,t.length):0,o=new Array(n),r=new Array(i),a;for(a=0;a<n;++a)o[a]=te(t[a],e[a]);for(;a<i;++a)r[a]=e[a];return function(s){for(a=0;a<n;++a)r[a]=o[a](s);return r}}function Yr(t,e){var i=new Date;return t=+t,e=+e,function(n){return i.setTime(t*(1-n)+e*n),i}}function q(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function Hr(t,e){var i={},n={},o;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(o in e)o in t?i[o]=te(t[o],e[o]):n[o]=e[o];return function(r){for(o in i)n[o]=i[o](r);return n}}var Ti=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ni=new RegExp(Ti.source,"g");function ql(t){return function(){return t}}function Bl(t){return function(e){return t(e)+""}}function je(t,e){var i=Ti.lastIndex=Ni.lastIndex=0,n,o,r,a=-1,s=[],l=[];for(t=t+"",e=e+"";(n=Ti.exec(t))&&(o=Ni.exec(e));)(r=o.index)>i&&(r=e.slice(i,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(o=o[0])?s[a]?s[a]+=o:s[++a]=o:(s[++a]=null,l.push({i:a,x:q(n,o)})),i=Ni.lastIndex;return i<e.length&&(r=e.slice(i),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?Bl(l[0].x):ql(e):(e=l.length,function(c){for(var u=0,f;u<e;++u)s[(f=l[u]).i]=f.x(c);return s.join("")})}function te(t,e){var i=typeof e,n;return e==null||i==="boolean"?Ge(e):(i==="number"?q:i==="string"?(n=dt(e))?(e=n,Jt):je:e instanceof dt?Jt:e instanceof Date?Yr:jr(e)?Gr:Array.isArray(e)?Xr:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Hr:q)(t,e)}function Ai(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}var Ur=180/Math.PI,Gn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Fi(t,e,i,n,o,r){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*i+e*n)&&(i-=t*l,n-=e*l),(s=Math.sqrt(i*i+n*n))&&(i/=s,n/=s,l/=s),t*n<e*i&&(t=-t,e=-e,l=-l,a=-a),{translateX:o,translateY:r,rotate:Math.atan2(e,t)*Ur,skewX:Math.atan(l)*Ur,scaleX:a,scaleY:s}}var jn;function Qr(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Gn:Fi(e.a,e.b,e.c,e.d,e.e,e.f)}function Kr(t){return t==null?Gn:(jn||(jn=document.createElementNS("http://www.w3.org/2000/svg","g")),jn.setAttribute("transform",t),(t=jn.transform.baseVal.consolidate())?(t=t.matrix,Fi(t.a,t.b,t.c,t.d,t.e,t.f)):Gn)}function Zr(t,e,i,n){function o(c){return c.length?c.pop()+" ":""}function r(c,u,f,p,m,_){if(c!==f||u!==p){var b=m.push("translate(",null,e,null,i);_.push({i:b-4,x:q(c,f)},{i:b-2,x:q(u,p)})}else(f||p)&&m.push("translate("+f+e+p+i)}function a(c,u,f,p){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),p.push({i:f.push(o(f)+"rotate(",null,n)-2,x:q(c,u)})):u&&f.push(o(f)+"rotate("+u+n)}function s(c,u,f,p){c!==u?p.push({i:f.push(o(f)+"skewX(",null,n)-2,x:q(c,u)}):u&&f.push(o(f)+"skewX("+u+n)}function l(c,u,f,p,m,_){if(c!==f||u!==p){var b=m.push(o(m)+"scale(",null,",",null,")");_.push({i:b-4,x:q(c,f)},{i:b-2,x:q(u,p)})}else(f!==1||p!==1)&&m.push(o(m)+"scale("+f+","+p+")")}return function(c,u){var f=[],p=[];return c=t(c),u=t(u),r(c.translateX,c.translateY,u.translateX,u.translateY,f,p),a(c.rotate,u.rotate,f,p),s(c.skewX,u.skewX,f,p),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,p),c=u=null,function(m){for(var _=-1,b=p.length,I;++_<b;)f[(I=p[_]).i]=I.x(m);return f.join("")}}}var Vi=Zr(Qr,"px, ","px)","deg)"),Li=Zr(Kr,", ",")",")");var Me=0,Ye=0,Xe=0,Jr=1e3,Xn,He,Yn=0,ee=0,Hn=0,Ue=typeof performance=="object"&&performance.now?performance:Date,ta=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ke(){return ee||(ta(Gl),ee=Ue.now()+Hn)}function Gl(){ee=0}function Qe(){this._call=this._time=this._next=null}Qe.prototype=Un.prototype={constructor:Qe,restart:function(t,e,i){if(typeof t!="function")throw new TypeError("callback is not a function");i=(i==null?Ke():+i)+(e==null?0:+e),!this._next&&He!==this&&(He?He._next=this:Xn=this,He=this),this._call=t,this._time=i,$i()},stop:function(){this._call&&(this._call=null,this._time=1/0,$i())}};function Un(t,e,i){var n=new Qe;return n.restart(t,e,i),n}function ea(){Ke(),++Me;for(var t=Xn,e;t;)(e=ee-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Me}function Wr(){ee=(Yn=Ue.now())+Hn,Me=Ye=0;try{ea()}finally{Me=0,Xl(),ee=0}}function jl(){var t=Ue.now(),e=t-Yn;e>Jr&&(Hn-=e,Yn=t)}function Xl(){for(var t,e=Xn,i,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(i=e._next,e._next=null,e=t?t._next=i:Xn=i);He=t,$i(n)}function $i(t){if(!Me){Ye&&(Ye=clearTimeout(Ye));var e=t-ee;e>24?(t<1/0&&(Ye=setTimeout(Wr,t-Ue.now()-Hn)),Xe&&(Xe=clearInterval(Xe))):(Xe||(Yn=Ue.now(),Xe=setInterval(jl,Jr)),Me=1,ta(Wr))}}function Qn(t,e,i){var n=new Qe;return e=e==null?0:+e,n.restart(o=>{n.stop(),t(o+e)},e,i),n}var Yl=bi("start","end","cancel","interrupt"),Hl=[],oa=0,na=1,Zn=2,Kn=3,ia=4,Wn=5,Ze=6;function Bt(t,e,i,n,o,r){var a=t.__transition;if(!a)t.__transition={};else if(i in a)return;Ul(t,i,{name:e,index:n,group:o,on:Yl,tween:Hl,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:oa})}function We(t,e){var i=F(t,e);if(i.state>oa)throw new Error("too late; already scheduled");return i}function B(t,e){var i=F(t,e);if(i.state>Kn)throw new Error("too late; already running");return i}function F(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function Ul(t,e,i){var n=t.__transition,o;n[e]=i,i.timer=Un(r,0,i.time);function r(c){i.state=na,i.timer.restart(a,i.delay,i.time),i.delay<=c&&a(c-i.delay)}function a(c){var u,f,p,m;if(i.state!==na)return l();for(u in n)if(m=n[u],m.name===i.name){if(m.state===Kn)return Qn(a);m.state===ia?(m.state=Ze,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete n[u]):+u<e&&(m.state=Ze,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete n[u])}if(Qn(function(){i.state===Kn&&(i.state=ia,i.timer.restart(s,i.delay,i.time),s(c))}),i.state=Zn,i.on.call("start",t,t.__data__,i.index,i.group),i.state===Zn){for(i.state=Kn,o=new Array(p=i.tween.length),u=0,f=-1;u<p;++u)(m=i.tween[u].value.call(t,t.__data__,i.index,i.group))&&(o[++f]=m);o.length=f+1}}function s(c){for(var u=c<i.duration?i.ease.call(null,c/i.duration):(i.timer.restart(l),i.state=Wn,1),f=-1,p=o.length;++f<p;)o[f].call(t,u);i.state===Wn&&(i.on.call("end",t,t.__data__,i.index,i.group),l())}function l(){i.state=Ze,i.timer.stop(),delete n[e];for(var c in n)return;delete t.__transition}}function Jn(t,e){var i=t.__transition,n,o,r=!0,a;if(i){e=e==null?null:e+"";for(a in i){if((n=i[a]).name!==e){r=!1;continue}o=n.state>Zn&&n.state<Wn,n.state=Ze,n.timer.stop(),n.on.call(o?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[a]}r&&delete t.__transition}}function ra(t){return this.each(function(){Jn(this,t)})}function Ql(t,e){var i,n;return function(){var o=B(this,t),r=o.tween;if(r!==i){n=i=r;for(var a=0,s=n.length;a<s;++a)if(n[a].name===e){n=n.slice(),n.splice(a,1);break}}o.tween=n}}function Kl(t,e,i){var n,o;if(typeof i!="function")throw new Error;return function(){var r=B(this,t),a=r.tween;if(a!==n){o=(n=a).slice();for(var s={name:e,value:i},l=0,c=o.length;l<c;++l)if(o[l].name===e){o[l]=s;break}l===c&&o.push(s)}r.tween=o}}function aa(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n=F(this.node(),i).tween,o=0,r=n.length,a;o<r;++o)if((a=n[o]).name===t)return a.value;return null}return this.each((e==null?Ql:Kl)(i,t,e))}function Se(t,e,i){var n=t._id;return t.each(function(){var o=B(this,n);(o.value||(o.value={}))[e]=i.apply(this,arguments)}),function(o){return F(o,n).value[e]}}function ti(t,e){var i;return(typeof e=="number"?q:e instanceof dt?Jt:(i=dt(e))?(e=i,Jt):je)(t,e)}function Zl(t){return function(){this.removeAttribute(t)}}function Wl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Jl(t,e,i){var n,o=i+"",r;return function(){var a=this.getAttribute(t);return a===o?null:a===n?r:r=e(n=a,i)}}function tc(t,e,i){var n,o=i+"",r;return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===n?r:r=e(n=a,i)}}function ec(t,e,i){var n,o,r;return function(){var a,s=i(this),l;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=s+"",a===l?null:a===n&&l===o?r:(o=l,r=e(n=a,s)))}}function nc(t,e,i){var n,o,r;return function(){var a,s=i(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=s+"",a===l?null:a===n&&l===o?r:(o=l,r=e(n=a,s)))}}function sa(t,e){var i=St(t),n=i==="transform"?Li:ti;return this.attrTween(t,typeof e=="function"?(i.local?nc:ec)(i,n,Se(this,"attr."+t,e)):e==null?(i.local?Wl:Zl)(i):(i.local?tc:Jl)(i,n,e))}function ic(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function oc(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function rc(t,e){var i,n;function o(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&oc(t,r)),i}return o._value=e,o}function ac(t,e){var i,n;function o(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&ic(t,r)),i}return o._value=e,o}function la(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;var n=St(t);return this.tween(i,(n.local?rc:ac)(n,e))}function sc(t,e){return function(){We(this,t).delay=+e.apply(this,arguments)}}function lc(t,e){return e=+e,function(){We(this,t).delay=e}}function ca(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?sc:lc)(e,t)):F(this.node(),e).delay}function cc(t,e){return function(){B(this,t).duration=+e.apply(this,arguments)}}function uc(t,e){return e=+e,function(){B(this,t).duration=e}}function ua(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?cc:uc)(e,t)):F(this.node(),e).duration}function fc(t,e){if(typeof e!="function")throw new Error;return function(){B(this,t).ease=e}}function fa(t){var e=this._id;return arguments.length?this.each(fc(e,t)):F(this.node(),e).ease}function pc(t,e){return function(){var i=e.apply(this,arguments);if(typeof i!="function")throw new Error;B(this,t).ease=i}}function pa(t){if(typeof t!="function")throw new Error;return this.each(pc(this._id,t))}function ma(t){typeof t!="function"&&(t=$e(t));for(var e=this._groups,i=e.length,n=new Array(i),o=0;o<i;++o)for(var r=e[o],a=r.length,s=n[o]=[],l,c=0;c<a;++c)(l=r[c])&&t.call(l,l.__data__,c,r)&&s.push(l);return new K(n,this._parents,this._name,this._id)}function da(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,o=i.length,r=Math.min(n,o),a=new Array(n),s=0;s<r;++s)for(var l=e[s],c=i[s],u=l.length,f=a[s]=new Array(u),p,m=0;m<u;++m)(p=l[m]||c[m])&&(f[m]=p);for(;s<n;++s)a[s]=e[s];return new K(a,this._parents,this._name,this._id)}function mc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var i=e.indexOf(".");return i>=0&&(e=e.slice(0,i)),!e||e==="start"})}function dc(t,e,i){var n,o,r=mc(e)?We:B;return function(){var a=r(this,t),s=a.on;s!==n&&(o=(n=s).copy()).on(e,i),a.on=o}}function ha(t,e){var i=this._id;return arguments.length<2?F(this.node(),i).on.on(t):this.each(dc(i,t,e))}function hc(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}function ga(){return this.on("end.remove",hc(this._id))}function xa(t){var e=this._name,i=this._id;typeof t!="function"&&(t=Kt(t));for(var n=this._groups,o=n.length,r=new Array(o),a=0;a<o;++a)for(var s=n[a],l=s.length,c=r[a]=new Array(l),u,f,p=0;p<l;++p)(u=s[p])&&(f=t.call(u,u.__data__,p,s))&&("__data__"in u&&(f.__data__=u.__data__),c[p]=f,Bt(c[p],e,i,p,c,F(u,i)));return new K(r,this._parents,e,i)}function va(t){var e=this._name,i=this._id;typeof t!="function"&&(t=Le(t));for(var n=this._groups,o=n.length,r=[],a=[],s=0;s<o;++s)for(var l=n[s],c=l.length,u,f=0;f<c;++f)if(u=l[f]){for(var p=t.call(u,u.__data__,f,l),m,_=F(u,i),b=0,I=p.length;b<I;++b)(m=p[b])&&Bt(m,e,i,b,p,_);r.push(p),a.push(u)}return new K(r,a,e,i)}var gc=kt.prototype.constructor;function _a(){return new gc(this._groups,this._parents)}function xc(t,e){var i,n,o;return function(){var r=qt(this,t),a=(this.style.removeProperty(t),qt(this,t));return r===a?null:r===i&&a===n?o:o=e(i=r,n=a)}}function ya(t){return function(){this.style.removeProperty(t)}}function vc(t,e,i){var n,o=i+"",r;return function(){var a=qt(this,t);return a===o?null:a===n?r:r=e(n=a,i)}}function _c(t,e,i){var n,o,r;return function(){var a=qt(this,t),s=i(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),qt(this,t))),a===l?null:a===n&&l===o?r:(o=l,r=e(n=a,s))}}function yc(t,e){var i,n,o,r="style."+e,a="end."+r,s;return function(){var l=B(this,t),c=l.on,u=l.value[r]==null?s||(s=ya(e)):void 0;(c!==i||o!==u)&&(n=(i=c).copy()).on(a,o=u),l.on=n}}function Ca(t,e,i){var n=(t+="")=="transform"?Vi:ti;return e==null?this.styleTween(t,xc(t,n)).on("end.style."+t,ya(t)):typeof e=="function"?this.styleTween(t,_c(t,n,Se(this,"style."+t,e))).each(yc(this._id,t)):this.styleTween(t,vc(t,n,e),i).on("end.style."+t,null)}function Cc(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}function wc(t,e,i){var n,o;function r(){var a=e.apply(this,arguments);return a!==o&&(n=(o=a)&&Cc(t,a,i)),n}return r._value=e,r}function wa(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,wc(t,e,i??""))}function bc(t){return function(){this.textContent=t}}function Mc(t){return function(){var e=t(this);this.textContent=e??""}}function ba(t){return this.tween("text",typeof t=="function"?Mc(Se(this,"text",t)):bc(t==null?"":t+""))}function Sc(t){return function(e){this.textContent=t.call(this,e)}}function kc(t){var e,i;function n(){var o=t.apply(this,arguments);return o!==i&&(e=(i=o)&&Sc(o)),e}return n._value=t,n}function Ma(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,kc(t))}function Sa(){for(var t=this._name,e=this._id,i=ei(),n=this._groups,o=n.length,r=0;r<o;++r)for(var a=n[r],s=a.length,l,c=0;c<s;++c)if(l=a[c]){var u=F(l,e);Bt(l,t,i,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new K(n,this._parents,t,i)}function ka(){var t,e,i=this,n=i._id,o=i.size();return new Promise(function(r,a){var s={value:a},l={value:function(){--o===0&&r()}};i.each(function(){var c=B(this,n),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),c.on=e}),o===0&&r()})}var Ic=0;function K(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function Ia(t){return kt().transition(t)}function ei(){return++Ic}var It=kt.prototype;K.prototype=Ia.prototype={constructor:K,select:xa,selectAll:va,selectChild:It.selectChild,selectChildren:It.selectChildren,filter:ma,merge:da,selection:_a,transition:Sa,call:It.call,nodes:It.nodes,node:It.node,size:It.size,empty:It.empty,each:It.each,on:ha,attr:sa,attrTween:la,style:Ca,styleTween:wa,text:ba,textTween:Ma,remove:ga,tween:aa,delay:ca,duration:ua,ease:fa,easeVarying:pa,end:ka,[Symbol.iterator]:It[Symbol.iterator]};function ni(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Oc={time:null,delay:0,duration:250,ease:ni};function Dc(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function Oa(t){var e,i;t instanceof K?(e=t._id,t=t._name):(e=ei(),(i=Oc).time=Ke(),t=t==null?null:t+"");for(var n=this._groups,o=n.length,r=0;r<o;++r)for(var a=n[r],s=a.length,l,c=0;c<s;++c)(l=a[c])&&Bt(l,t,e,c,a,i||Dc(l,e));return new K(n,this._parents,t,e)}kt.prototype.interrupt=ra;kt.prototype.transition=Oa;var{abs:vg,max:_g,min:yg}=Math;function Da(t){return[+t[0],+t[1]]}function Ec(t){return[Da(t[0]),Da(t[1])]}var Cg={name:"x",handles:["w","e"].map(Ri),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},wg={name:"y",handles:["n","s"].map(Ri),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},bg={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ri),input:function(t){return t==null?null:Ec(t)},output:function(t){return t}};function Ri(t){return{type:t}}function Ea(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ne(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,n=t.slice(0,i);return[n.length>1?n[0]+n.slice(2):n,+t.slice(i+1)]}function vt(t){return t=ne(Math.abs(t)),t?t[1]:NaN}function Pa(t,e){return function(i,n){for(var o=i.length,r=[],a=0,s=t[0],l=0;o>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),r.push(i.substring(o-=s,o+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return r.reverse().join(e)}}function Na(t){return function(e){return e.replace(/[0-9]/g,function(i){return t[+i]})}}var Pc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gt(t){if(!(e=Pc.exec(t)))throw new Error("invalid format: "+t);var e;return new ii({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Gt.prototype=ii.prototype;function ii(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ii.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ta(t){t:for(var e=t.length,i=1,n=-1,o;i<e;++i)switch(t[i]){case".":n=o=i;break;case"0":n===0&&(n=i),o=i;break;default:if(!+t[i])break t;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(o+1):t}var zi;function Aa(t,e){var i=ne(t,e);if(!i)return t+"";var n=i[0],o=i[1],r=o-(zi=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,a=n.length;return r===a?n:r>a?n+new Array(r-a+1).join("0"):r>0?n.slice(0,r)+"."+n.slice(r):"0."+new Array(1-r).join("0")+ne(t,Math.max(0,e+r-1))[0]}function qi(t,e){var i=ne(t,e);if(!i)return t+"";var n=i[0],o=i[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}var Bi={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ea,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>qi(t*100,e),r:qi,s:Aa,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Gi(t){return t}var Fa=Array.prototype.map,Va=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function La(t){var e=t.grouping===void 0||t.thousands===void 0?Gi:Pa(Fa.call(t.grouping,Number),t.thousands+""),i=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",r=t.numerals===void 0?Gi:Na(Fa.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"\u2212":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(f){f=Gt(f);var p=f.fill,m=f.align,_=f.sign,b=f.symbol,I=f.zero,U=f.width,G=f.comma,T=f.precision,ot=f.trim,D=f.type;D==="n"?(G=!0,D="g"):Bi[D]||(T===void 0&&(T=12),ot=!0,D="g"),(I||p==="0"&&m==="=")&&(I=!0,p="0",m="=");var Ot=b==="$"?i:b==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",ct=b==="$"?n:/[%p]/.test(D)?a:"",ie=Bi[D],oe=/[defgprs%]/.test(D);T=T===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,T)):Math.max(0,Math.min(20,T));function Dt(C){var j=Ot,z=ct,re,eo,en;if(D==="c")z=ie(C)+z,C="";else{C=+C;var nn=C<0||1/C<0;if(C=isNaN(C)?l:ie(Math.abs(C),T),ot&&(C=Ta(C)),nn&&+C==0&&_!=="+"&&(nn=!1),j=(nn?_==="("?_:s:_==="-"||_==="("?"":_)+j,z=(D==="s"?Va[8+zi/3]:"")+z+(nn&&_==="("?")":""),oe){for(re=-1,eo=C.length;++re<eo;)if(en=C.charCodeAt(re),48>en||en>57){z=(en===46?o+C.slice(re+1):C.slice(re))+z,C=C.slice(0,re);break}}}G&&!I&&(C=e(C,1/0));var on=j.length+C.length+z.length,_t=on<U?new Array(U-on+1).join(p):"";switch(G&&I&&(C=e(_t+C,_t.length?U-z.length:1/0),_t=""),m){case"<":C=j+C+z+_t;break;case"=":C=j+_t+C+z;break;case"^":C=_t.slice(0,on=_t.length>>1)+j+C+z+_t.slice(on);break;default:C=_t+j+C+z;break}return r(C)}return Dt.toString=function(){return f+""},Dt}function u(f,p){var m=c((f=Gt(f),f.type="f",f)),_=Math.max(-8,Math.min(8,Math.floor(vt(p)/3)))*3,b=Math.pow(10,-_),I=Va[8+_/3];return function(U){return m(b*U)+I}}return{format:c,formatPrefix:u}}var oi,ke,ri;ji({thousands:",",grouping:[3],currency:["$",""]});function ji(t){return oi=La(t),ke=oi.format,ri=oi.formatPrefix,oi}function Xi(t){return Math.max(0,-vt(Math.abs(t)))}function Yi(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vt(e)/3)))*3-vt(Math.abs(t)))}function Hi(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vt(e)-vt(t))+1}function Ie(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var $a=Symbol("implicit");function ai(){var t=new ye,e=[],i=[],n=$a;function o(r){let a=t.get(r);if(a===void 0){if(n!==$a)return n;t.set(r,a=e.push(r)-1)}return i[a%i.length]}return o.domain=function(r){if(!arguments.length)return e.slice();e=[],t=new ye;for(let a of r)t.has(a)||t.set(a,e.push(a)-1);return o},o.range=function(r){return arguments.length?(i=Array.from(r),o):i.slice()},o.unknown=function(r){return arguments.length?(n=r,o):n},o.copy=function(){return ai(e,i).unknown(n)},Ie.apply(o,arguments),o}function Je(){var t=ai().unknown(void 0),e=t.domain,i=t.range,n=0,o=1,r,a,s=!1,l=0,c=0,u=.5;delete t.unknown;function f(){var p=e().length,m=o<n,_=m?o:n,b=m?n:o;r=(b-_)/Math.max(1,p-l+c*2),s&&(r=Math.floor(r)),_+=(b-_-r*(p-l))*u,a=r*(1-l),s&&(_=Math.round(_),a=Math.round(a));var I=Ce(p).map(function(U){return _+r*U});return i(m?I.reverse():I)}return t.domain=function(p){return arguments.length?(e(p),f()):e()},t.range=function(p){return arguments.length?([n,o]=p,n=+n,o=+o,f()):[n,o]},t.rangeRound=function(p){return[n,o]=p,n=+n,o=+o,s=!0,f()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(p){return arguments.length?(s=!!p,f()):s},t.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),f()):l},t.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),f()):l},t.paddingOuter=function(p){return arguments.length?(c=+p,f()):c},t.align=function(p){return arguments.length?(u=Math.max(0,Math.min(1,p)),f()):u},t.copy=function(){return Je(e(),[n,o]).round(s).paddingInner(l).paddingOuter(c).align(u)},Ie.apply(f(),arguments)}function Ui(t){return function(){return t}}function Qi(t){return+t}var Ra=[0,1];function Oe(t){return t}function Ki(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:Ui(isNaN(e)?NaN:.5)}function Nc(t,e){var i;return t>e&&(i=t,t=e,e=i),function(n){return Math.max(t,Math.min(e,n))}}function Tc(t,e,i){var n=t[0],o=t[1],r=e[0],a=e[1];return o<n?(n=Ki(o,n),r=i(a,r)):(n=Ki(n,o),r=i(r,a)),function(s){return r(n(s))}}function Ac(t,e,i){var n=Math.min(t.length,e.length)-1,o=new Array(n),r=new Array(n),a=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<n;)o[a]=Ki(t[a],t[a+1]),r[a]=i(e[a],e[a+1]);return function(s){var l=gi(t,s,1,n)-1;return r[l](o[l](s))}}function za(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Fc(){var t=Ra,e=Ra,i=te,n,o,r,a=Oe,s,l,c;function u(){var p=Math.min(t.length,e.length);return a!==Oe&&(a=Nc(t[0],t[p-1])),s=p>2?Ac:Tc,l=c=null,f}function f(p){return p==null||isNaN(p=+p)?r:(l||(l=s(t.map(n),e,i)))(n(a(p)))}return f.invert=function(p){return a(o((c||(c=s(e,t.map(n),q)))(p)))},f.domain=function(p){return arguments.length?(t=Array.from(p,Qi),u()):t.slice()},f.range=function(p){return arguments.length?(e=Array.from(p),u()):e.slice()},f.rangeRound=function(p){return e=Array.from(p),i=Ai,u()},f.clamp=function(p){return arguments.length?(a=p?!0:Oe,u()):a!==Oe},f.interpolate=function(p){return arguments.length?(i=p,u()):i},f.unknown=function(p){return arguments.length?(r=p,f):r},function(p,m){return n=p,o=m,u()}}function Zi(){return Fc()(Oe,Oe)}function Wi(t,e,i,n){var o=xi(t,e,i),r;switch(n=Gt(n??",f"),n.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(r=Yi(o,a))&&(n.precision=r),ri(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(r=Hi(o,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=r-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(r=Xi(o))&&(n.precision=r-(n.type==="%")*2);break}}return ke(n)}function Vc(t){var e=t.domain;return t.ticks=function(i){var n=e();return En(n[0],n[n.length-1],i??10)},t.tickFormat=function(i,n){var o=e();return Wi(o[0],o[o.length-1],i??10,n)},t.nice=function(i){i==null&&(i=10);var n=e(),o=0,r=n.length-1,a=n[o],s=n[r],l,c,u=10;for(s<a&&(c=a,a=s,s=c,c=o,o=r,r=c);u-- >0;){if(c=Fe(a,s,i),c===l)return n[o]=a,n[r]=s,e(n);if(c>0)a=Math.floor(a/c)*c,s=Math.ceil(s/c)*c;else if(c<0)a=Math.ceil(a*c)/c,s=Math.floor(s*c)/c;else break;l=c}return t},t}function tn(){var t=Zi();return t.copy=function(){return za(t,tn())},Ie.apply(t,arguments),Vc(t)}function jt(t,e,i){this.k=t,this.x=e,this.y=i}jt.prototype={constructor:jt,scale:function(t){return t===1?this:new jt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new jt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ji=new jt(1,0,0);to.prototype=jt.prototype;function to(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Ji;return t.__zoom}var qa=Ga(ja());function $c(t,e){if(t&1&&(h(0,"div")(1,"h2"),g(2),d(),h(3,"p")(4,"span",5),g(5,"Created on:"),d(),g(6),ln(7,"date"),d(),h(8,"p")(9,"span",5),g(10,"Status:"),d(),g(11),d(),h(12,"p")(13,"span",5),g(14,"Composition:"),d(),g(15),d(),h(16,"p")(17,"span",5),g(18,"Location:"),d(),g(19),d()()),t&2){let i=N();y("@fadeIn",void 0),x(2),X("Details for ",i.details.device.name,""),x(4),X(" ",cn(7,6,i.details.device.creationAt)," "),x(5),X(" ",i.details.device.status.isOperational?"Operational":"Not operational"," "),x(4),X(" ",i.details.composition.code," "),x(4),X(" ",i.details.composition.location.label," ")}}function Rc(t,e){t&1&&E(0,"app-no-data")}var Ba=(()=>{let e=class e{constructor(n,o,r){this.route=n,this.store=o,this.changeRef=r}ngOnInit(){let n=Number(this.route.snapshot.paramMap.get("deviceId"));this.store.dispatch(v.getDeviceDetails({id:n})),this.store.select(bo).pipe(yt(o=>o!==void 0),Q(1)).subscribe(o=>{this.details=o;let r=o?.timeline??[];r.length>0&&(this.filledStatusTimeLine=this.fillEmptyDates(r),this.createChart(this.filledStatusTimeLine)),this.changeRef.markForCheck()})}fillEmptyDates(n){let o=n.map(a=>a.date),r=[];for(let a=29;a>=0;a--){let s=(0,qa.default)().clone().subtract(a,"days").format("YYYY-MM-DD");if(!o.includes(s))r.push({date:s,occurrences:0});else{let l=n.find(c=>c.date===s);l!==void 0&&r.push(l)}}return r}createChart(n){let o={top:30,right:30,bottom:70,left:60},r=860-o.left-o.right,a=300-o.top-o.bottom,s=Oi("#chart").append("svg").attr("width",r+o.left+o.right).attr("height",a+o.top+o.bottom).append("g").attr("transform",`translate(${o.left},${o.top})`),l=Je().range([0,r]).domain(n.map(f=>f.date)).padding(.2);s.append("g").attr("transform",`translate(0, ${a})`).call(Ci(l)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end");let c=tn().domain([0,this.getYExtremum(n)]).range([a,0]),u=wi(c).tickFormat(ke("d")).tickValues(Ce(this.getYExtremum(n)+1));s.append("g").call(u),s.selectAll("mybar").data(n).join("rect").attr("x",f=>l(f.date)??0).attr("y",f=>c(f.occurrences)).attr("width",l.bandwidth()).attr("height",f=>a-c(f.occurrences)).attr("fill","#e68080")}getYExtremum(n){return Math.max(0,...n.map(o=>o.occurrences))}};e.\u0275fac=function(o){return new(o||e)(w(dn),w(R),w(ht))},e.\u0275cmp=V({type:e,selectors:[["app-device-details"]],standalone:!0,features:[L],decls:8,vars:3,consts:[[1,"wrapper"],[1,"details"],[1,"chart"],[1,"titles"],["id","chart"],[1,"bold"]],template:function(o,r){o&1&&(h(0,"div",0)(1,"mat-card",1),P(2,$c,20,8,"div"),d(),h(3,"mat-card",2)(4,"h2",3),g(5,"Faulty statuses from last 30 days"),d(),E(6,"div",4),P(7,Rc,1,0,"app-no-data"),d()()),o&2&&(x(2),Ct(2,r.details?2:-1),x(4),y("@fadeIn",void 0),x(1),Ct(7,r.filledStatusTimeLine?-1:7))},dependencies:[H,lt,Y,mn,Rt],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0 5vw;height:100%}.wrapper[_ngcontent-%COMP%]   .chart[_ngcontent-%COMP%]{padding:30px 0;background-color:#f2f8ef;min-height:400px;width:100%;overflow-y:visible}.wrapper[_ngcontent-%COMP%]   .chart[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(.example-viewport, .table[_ngcontent-%COMP%], app-no-data)[_ngcontent-%COMP%]{margin-left:45px;margin-right:45px}.wrapper[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{padding:30px 0;margin-bottom:10px;min-height:300px;width:100%;background-color:#f2f8ef}.wrapper[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(.example-viewport, .table[_ngcontent-%COMP%], app-no-data)[_ngcontent-%COMP%]{margin-left:45px;margin-right:45px}.wrapper[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:500;font-size:16px}"],data:{animation:[gt]},changeDetection:0});let t=e;return t})();var t_=[{path:"",component:_o,providers:[fo({name:bn,reducer:Oo}),go([Do])],children:[{path:"",component:Io},{path:":id",component:To},{path:"device-details/:deviceId",component:Ba}]}];export{t_ as COMPOSITIONS_ROUTES};
