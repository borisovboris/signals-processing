import{c as d,d as E,i as tt,j as et,k as rt,o as it,q as g,r as nt,s as st}from"./chunk-7FJ4ADOC.js";import{$ as S,A as B,C as Q,F as j,G as Y,N as b,P as p,R as a,S as c,T as l,Ua as Z,a as h,aa as y,b as A,g as H,h as L,ha as T,hb as w,ib as J,jb as X,kb as U,lb as D,ob as W,q as m,r as M,t as N,u as v,v as $,y as q,z as K}from"./chunk-OWV6CK4N.js";var Tt={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},C="__@ngrx/effects_create__";function ae(t,e={}){let n=e.functional?t:t(),r=h(h({},Tt),e);return Object.defineProperty(n,C,{value:r}),n}function Ct(t){return Object.getOwnPropertyNames(t).filter(r=>t[r]&&t[r].hasOwnProperty(C)?t[r][C].hasOwnProperty("dispatch"):!1).map(r=>{let i=t[r][C];return h({propertyName:r},i)})}function It(t){return Ct(t)}function ot(t){return Object.getPrototypeOf(t)}function Ot(t){return!!t.constructor&&t.constructor.name!=="Object"&&t.constructor.name!=="Function"}function ct(t){return typeof t=="function"}function Ft(t){return t.filter(ct)}function At(t,e,n){let r=ot(t),s=!!r&&r.constructor.name!=="Object"?r.constructor.name:null,o=It(t).map(({propertyName:u,dispatch:R,useEffectsErrorHandler:gt})=>{let V=typeof t[u]=="function"?t[u]():t[u],G=gt?n(V,e):V;return R===!1?G.pipe(K()):G.pipe(Y()).pipe(m(Rt=>({effect:t[u],notification:Rt,propertyName:u,sourceName:s,sourceInstance:t})))});return N(...o)}var Mt=10;function at(t,e,n=Mt){return t.pipe($(r=>(e&&e.handleError(r),n<=1?t:at(t,e,n-1))))}var fe=(()=>{let e=class e extends H{constructor(r){super(),r&&(this.source=r)}lift(r){let i=new e;return i.source=this,i.operator=r,i}};e.\u0275fac=function(i){return new(i||e)(c(it))},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ue(...t){return v(e=>t.some(n=>typeof n=="string"?n===e.type:n.type===e.type))}var le=new a("@ngrx/effects Internal Root Guard"),de=new a("@ngrx/effects User Provided Effects"),he=new a("@ngrx/effects Internal Root Effects"),pe=new a("@ngrx/effects Internal Root Effects Instances"),Ee=new a("@ngrx/effects Internal Feature Effects"),ge=new a("@ngrx/effects Internal Feature Effects Instance Groups"),Nt=new a("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>at}),jt="@ngrx/effects/init",bt=d(jt);function wt(t,e){if(t.notification.kind==="N"){let n=t.notification.value;!Ut(n)&&e.handleError(new Error(`Effect ${Dt(t)} dispatched an invalid action: ${zt(n)}`))}}function Ut(t){return typeof t!="function"&&t&&t.type&&typeof t.type=="string"}function Dt({propertyName:t,sourceInstance:e,sourceName:n}){let r=typeof e[t]=="function";return!!n?`"${n}.${String(t)}${r?"()":""}"`:`"${String(t)}()"`}function zt(t){try{return JSON.stringify(t)}catch{return t}}var Pt="ngrxOnIdentifyEffects";function xt(t){return z(t,Pt)}var _t="ngrxOnRunEffects";function kt(t){return z(t,_t)}var Vt="ngrxOnInitEffects";function Gt(t){return z(t,Vt)}function z(t,e){return t&&e in t&&typeof t[e]=="function"}var ft=(()=>{let e=class e extends L{constructor(r,i){super(),this.errorHandler=r,this.effectsErrorHandler=i}addEffects(r){this.next(r)}toActions(){return this.pipe(j(r=>Ot(r)?ot(r):r),M(r=>r.pipe(j(Ht))),M(r=>{let i=r.pipe(Q(o=>Lt(this.errorHandler,this.effectsErrorHandler)(o)),m(o=>(wt(o,this.errorHandler),o.notification)),v(o=>o.kind==="N"&&o.value!=null),B()),s=r.pipe(q(1),v(Gt),m(o=>o.ngrxOnInitEffects()));return N(i,s)}))}};e.\u0275fac=function(i){return new(i||e)(c(T),c(Nt))},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ht(t){return xt(t)?t.ngrxOnIdentifyEffects():""}function Lt(t,e){return n=>{let r=At(n,t,e);return kt(n)?n.ngrxOnRunEffects(r):r}}var $t=(()=>{let e=class e{get isStarted(){return!!this.effectsSubscription}constructor(r,i){this.effectSources=r,this.store=i,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}};e.\u0275fac=function(i){return new(i||e)(c(ft),c(g))},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Re(...t){let e=t.flat(),n=Ft(e);return y([n,{provide:S,multi:!0,useValue:()=>{l(et),l(rt,{optional:!0});let r=l($t),i=l(ft),s=!r.isStarted;s&&r.start();for(let o of e){let u=ct(o)?l(o):o;i.addEffects(u)}s&&l(g).dispatch(bt())}}])}var ht="@ngrx/router-store/request",je=d(ht,E()),P="@ngrx/router-store/navigation",be=d(P,E()),x="@ngrx/router-store/cancel",we=d(x,E()),_="@ngrx/router-store/error",Ue=d(_,E()),pt="@ngrx/router-store/navigated",De=d(pt,E());function ze(t,e){let n=e;switch(n.type){case P:case _:case x:return{state:n.payload.routerState,navigationId:n.payload.event.id};default:return t}}var I=class{serialize(e){return{root:this.serializeRoute(e.root),url:e.url}}serializeRoute(e){let n=e.children.map(r=>this.serializeRoute(r));return{params:e.params,data:e.data,url:e.url,outlet:e.outlet,title:e.title,routeConfig:e.routeConfig?{path:e.routeConfig.path,pathMatch:e.routeConfig.pathMatch,redirectTo:e.routeConfig.redirectTo,outlet:e.routeConfig.outlet,title:typeof e.routeConfig.title=="string"?e.routeConfig.title:void 0}:null,queryParams:e.queryParams,fragment:e.fragment,firstChild:n[0],children:n}}},k=function(t){return t[t.PreActivation=1]="PreActivation",t[t.PostActivation=2]="PostActivation",t}(k||{}),qt="router",ut=new a("@ngrx/router-store Internal Configuration"),Et=new a("@ngrx/router-store Configuration");function Kt(t){return h({stateKey:qt,serializer:I,navigationActionTiming:k.PreActivation},t)}var O=class{serialize(e){return{root:this.serializeRoute(e.root),url:e.url}}serializeRoute(e){let n=e.children.map(r=>this.serializeRoute(r));return{params:e.params,paramMap:e.paramMap,data:e.data,url:e.url,outlet:e.outlet,title:e.title,routeConfig:e.routeConfig?{component:e.routeConfig.component,path:e.routeConfig.path,pathMatch:e.routeConfig.pathMatch,redirectTo:e.routeConfig.redirectTo,outlet:e.routeConfig.outlet,title:e.routeConfig.title}:null,queryParams:e.queryParams,queryParamMap:e.queryParamMap,fragment:e.fragment,component:e.routeConfig?e.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:n[0],pathFromRoot:void 0,children:n}}},F=class{},f=function(t){return t[t.NONE=1]="NONE",t[t.ROUTER=2]="ROUTER",t[t.STORE=3]="STORE",t}(f||{}),lt=(()=>{let e=class e{constructor(r,i,s,o,u,R){this.store=r,this.router=i,this.serializer=s,this.errorHandler=o,this.config=u,this.activeRuntimeChecks=R,this.lastEvent=null,this.routerState=null,this.trigger=f.NONE,this.stateKey=this.config.stateKey,!st()&&Z()&&(R?.strictActionSerializability||R?.strictStateSerializability)&&this.serializer instanceof O&&console.warn("@ngrx/router-store: The serializability runtime checks cannot be enabled with the FullRouterStateSerializer. The FullRouterStateSerializer has an unserializable router state and actions that are not serializable. To use the serializability runtime checks either use the MinimalRouterStateSerializer or implement a custom router state serializer."),this.setUpStoreStateListener(),this.setUpRouterEventsListener()}setUpStoreStateListener(){this.store.pipe(nt(this.stateKey),b(this.store)).subscribe(([r,i])=>{this.navigateIfNeeded(r,i)})}navigateIfNeeded(r,i){if(!r||!r.state||this.trigger===f.ROUTER||this.lastEvent instanceof w)return;let s=r.state.url;Bt(this.router.url,s)||(this.storeState=i,this.trigger=f.STORE,this.router.navigateByUrl(s).catch(o=>{this.errorHandler.handleError(o)}))}setUpRouterEventsListener(){let r=this.config.navigationActionTiming===k.PostActivation,i;this.router.events.pipe(b(this.store)).subscribe(([s,o])=>{this.lastEvent=s,s instanceof w?(this.routerState=this.serializer.serialize(this.router.routerState.snapshot),this.trigger!==f.STORE&&(this.storeState=o,this.dispatchRouterRequest(s))):s instanceof D?(i=s,!r&&this.trigger!==f.STORE&&this.dispatchRouterNavigation(s)):s instanceof X?(this.dispatchRouterCancel(s),this.reset()):s instanceof U?(this.dispatchRouterError(s),this.reset()):s instanceof J&&(this.trigger!==f.STORE&&(r&&this.dispatchRouterNavigation(i),this.dispatchRouterNavigated(s)),this.reset())})}dispatchRouterRequest(r){this.dispatchRouterAction(ht,{event:r})}dispatchRouterNavigation(r){let i=this.serializer.serialize(r.state);this.dispatchRouterAction(P,{routerState:i,event:new D(r.id,r.url,r.urlAfterRedirects,i)})}dispatchRouterCancel(r){this.dispatchRouterAction(x,{storeState:this.storeState,event:r})}dispatchRouterError(r){this.dispatchRouterAction(_,{storeState:this.storeState,event:new U(r.id,r.url,`${r}`)})}dispatchRouterNavigated(r){let i=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction(pt,{event:r,routerState:i})}dispatchRouterAction(r,i){this.trigger=f.ROUTER;try{this.store.dispatch({type:r,payload:A(h({routerState:this.routerState},i),{event:this.config.routerState===0?i.event:{id:i.event.id,url:i.event.url,urlAfterRedirects:i.event.urlAfterRedirects}})})}finally{this.trigger=f.NONE}}reset(){this.trigger=f.NONE,this.storeState=null,this.routerState=null}};e.\u0275fac=function(i){return new(i||e)(c(g),c(W),c(F),c(T),c(Et),c(tt))},e.\u0275prov=p({token:e,factory:e.\u0275fac});let t=e;return t})();function Bt(t,e){return dt(t)===dt(e)}function dt(t){return t?.length>0&&t[t.length-1]==="/"?t.substring(0,t.length-1):t}function Pe(t={}){return y([{provide:ut,useValue:t},{provide:Et,useFactory:Kt,deps:[ut]},{provide:F,useClass:t.serializer?t.serializer:t.routerState===0?O:I},{provide:S,multi:!0,useFactory(){return()=>l(lt)}},lt])}export{ae as a,fe as b,ue as c,Re as d,be as e,De as f,ze as g,Pe as h};
