<div class="wrapper" *ngIf="compositions$ | async as compositions">
  <mat-card class="sidebar">
    <h2>Filters</h2>
    <form [formGroup]="sidepanelForm" @fadeIn>
      <app-autocomplete-chips
        #locationChips
        [options$]="locationOptions$"
        label="Locations"
        placeholder="Location..."
        [itemsCtrl]="locationsCtrl"
        [textCtrl]="locationCtrl"
        (inputTextChanged)="handleLocationInput($event)"
        (chipsChanged)="handleLocationChipsChange()"
      ></app-autocomplete-chips>
      <app-autocomplete-chips
        #cityChips
        [options$]="cityOptions$"
        label="Cities"
        placeholder="City..."
        [itemsCtrl]="citiesCtrl"
        [textCtrl]="cityCtrl"
        (inputTextChanged)="handleCityInput($event)"
        (chipsChanged)="handleCityChipsChange()"
      ></app-autocomplete-chips>
    </form>
  </mat-card>

  <mat-card class="list">
    <div class="heading">
      <h2>Compositions</h2>
      <button mat-raised-button color="accent" (click)="openCountryForm()">
        Add composition
      </button>
    </div>
    <div class="columns">
      <p>Code</p>
      <p>Devices</p>
      <p>Status</p>
    </div>
    <cdk-virtual-scroll-viewport
      CdkScrollable
      [itemSize]="60"
      class="example-viewport"
      @fadeIn
    >
      <div class="row-wrapper" *cdkVirtualFor="let composition of compositions">
        <div
          class="row mat-elevation-z2"
          [class.not-operational]="!composition.status.isOperational"
          (click)="goToDetails(composition.id)"
        >
          <p>{{ composition.code }}</p>
          <p>{{ composition.devicesSize }}</p>
          <p>{{ getOperationalLabel(composition.status.isOperational) }}</p>
        </div>
      </div>
    </cdk-virtual-scroll-viewport>
  </mat-card>
</div>
